<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-DifferentialEquations" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Using Differential Equations | GAMA Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gama-platform.org/resources/images/general/GamaPlatform.png"><meta data-rh="true" name="twitter:image" content="https://gama-platform.org/resources/images/general/GamaPlatform.png"><meta data-rh="true" property="og:url" content="https://gama-platform.org/wiki/next/DifferentialEquations"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using Differential Equations | GAMA Platform"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/gama-logo.png"><link data-rh="true" rel="canonical" href="https://gama-platform.org/wiki/next/DifferentialEquations"><link data-rh="true" rel="alternate" href="https://gama-platform.org/wiki/next/DifferentialEquations" hreflang="en"><link data-rh="true" rel="alternate" href="https://gama-platform.org/wiki/next/DifferentialEquations" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://MWUOLTL2EG-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="GAMA Platform RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="GAMA Platform Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="GAMA Platform" href="/opensearch.xml">


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.1/css/all.css">
<script src="/js/blogFacebook-iFrame.js" async></script><link rel="stylesheet" href="/assets/css/styles.d1c0242c.css">
<link rel="preload" href="/assets/js/runtime~main.2b69a667.js" as="script">
<link rel="preload" href="/assets/js/main.75fc2077.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#34709f;color:#e3e3e3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ðŸŽ‰ <strong>GAMA Platform 1.9.2 is out!!</strong> ðŸŽ‰ <a href="/download"><u>Download it now</u></a> and check <a href="/wiki/Changelog"><u>the changelog</u></a>!! ðŸŽ‰</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/gama-logo.png" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/gama-logo.png" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">GAMA Platform</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/wiki/next/Home">Documentation</a><a class="navbar__item navbar__link" href="/wiki/next/Tutorials">Tutorials</a><a class="navbar__item navbar__link" href="/wiki/next/Community">Community</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gama-platform/gama" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="fab fa-github" style="font-size: 24px;"></i></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div id="sidebarCssSelector"><div class="custom-sidebarVersion"><p><u style="padding-top:4px;display:inline-block"><b>Version:</b></u> </p><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/wiki/next/Home">ðŸš§ 1.9.3 ðŸš§</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/wiki/next/DifferentialEquations">ðŸš§ 1.9.3 ðŸš§</a></li><li><a class="dropdown__link" href="/wiki/DifferentialEquations">1.9.2</a></li><li><a class="dropdown__link" href="/wiki/1.9.1/DifferentialEquations">1.9.1</a></li><li><a class="dropdown__link" href="/wiki/1.8.2-RC2/DifferentialEquations">1.8.2-RC2</a></li><li><a class="dropdown__link" href="/wiki/1.8.1/Home">1.8.1</a></li></ul></div><p></p></div><hr style="margin:0"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wiki/next/Home">Home</a><button aria-label="Toggle the collapsible sidebar category &#x27;Home&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wiki/next/PlatformDocumentation">Platform</a><button aria-label="Toggle the collapsible sidebar category &#x27;Platform&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/wiki/next/LearnGAMLStepByStep">Learn GAML step by step</a><button aria-label="Toggle the collapsible sidebar category &#x27;Learn GAML step by step&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wiki/next/Introduction">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/next/ManipulateBasicSpecies">Manipulate basic species</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wiki/next/GlobalSpecies">Global Species</a><button aria-label="Toggle the collapsible sidebar category &#x27;Global Species&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wiki/next/DefiningAdvancedSpecies">Defining Advanced Species</a><button aria-label="Toggle the collapsible sidebar category &#x27;Defining Advanced Species&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wiki/next/DefiningGUIExperiment">Defining GUI Experiment</a><button aria-label="Toggle the collapsible sidebar category &#x27;Defining GUI Experiment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wiki/next/ExploringModels">Exploring Models</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploring Models&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/wiki/next/OptimizingModelsSection">Optimizing Model Section</a><button aria-label="Toggle the collapsible sidebar category &#x27;Optimizing Model Section&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/wiki/next/MultiParadigmModeling">Multi-Paradigm Modeling</a><button aria-label="Toggle the collapsible sidebar category &#x27;Multi-Paradigm Modeling&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/next/ControlArchitecture">Control Architectures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/wiki/next/DifferentialEquations">Using Differential Equations</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wiki/next/Recipes">Recipes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recipes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wiki/next/GamlReference">GAML References</a><button aria-label="Toggle the collapsible sidebar category &#x27;GAML References&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/wiki/next/developingGAMA">Developing GAMA</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developing GAMA&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->GAMA Platform<!-- --> <b>ðŸš§ 1.9.3 ðŸš§</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/wiki/DifferentialEquations">latest version</a></b> (<!-- -->1.9.2<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/wiki/next/LearnGAMLStepByStep"><span itemprop="name">Learn GAML step by step</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/wiki/next/MultiParadigmModeling"><span itemprop="name">Multi-Paradigm Modeling</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using Differential Equations</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: ðŸš§ 1.9.3 ðŸš§</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using Differential Equations</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">â€‹</a></h2><p>ODEs (Ordinary Differential Equations) models are often used in physics, chemistry, biology, ecology and epidemiology. They allow tracking continuous changes of a system, and offer the possibility of a mathematical analysis. The possibility to find a numerical solution (for a given Cauchy problem) of first order differential equations has been implemented in Gama.</p><p>In population dynamics, systems of ODEs are used to describe the macroscopic evolution over time of a population, which is usually split into several compartments. The state of the population is described by the number of individuals in each compartment. Each equation of the ODE system describes the evolution of the number of individuals in a compartment. In such an approach, individuals are not taken into account individually, with own features and behaviors. On the contrary, they are aggregated and only the population density is considered.</p><p>Compartmental models are widely used to represent the spread of a disease in a population, with a large variety of models derived from the classical Kermack-McKendrick model, often referred to as the SIR model. More information about compartmental models in epidemiology can be found <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology" target="_blank" rel="noopener noreferrer">here</a>.</p><p>In SIR class models, the population is split into 3 (or more) compartments: S (Susceptible), I (Infected), R (Recovered). It is not usually possible to find an analytical solution of the ODE system, and an approximate solution has to be found, using various numerical schemes (such as Euler, Runge-Kutta, Dormand-Prince...)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-of-a-sir-model">Example of a SIR model<a href="#example-of-a-sir-model" class="hash-link" aria-label="Direct link to Example of a SIR model" title="Direct link to Example of a SIR model">â€‹</a></h2><p>In the SIR model, the population is split into 3 compartments: S (Susceptible), I (Infected), R (Recovered). Susceptible individuals become infected (move from compartment S to I) at a rate proportional to the size of both S and I populations. People recover (are removed from compartment I) at a constant rate. This can be represented by the following Forrester diagram: boxes represent compartments and arrows are flows. Arrows hold the rate of a compartment population flowing to another compartment.</p><p><img loading="lazy" alt="SIR compartment representation." src="data:image/png;base64,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" width="1254" height="212" class="img_ev3q"></p><p>The corresponding ODE system contains one equation per compartment. For example, the I compartment evolution is influenced by an inner (so positive) flow from the S compartment and an outer (so negative) flow to the R compartment.</p><p><img loading="lazy" alt="SIR equation system." src="/assets/images/SIR-equations-0e1a9d7af65d1d67d203d124cc3d0590.png" width="1566" height="720" class="img_ev3q"></p><p>Given an initial condition (initial values) at time t=0, such as</p><ul><li>S = 499</li><li>I = 1</li><li>R = 0</li><li>beta = 0.4</li><li>gamma = 0.1 </li><li>h = 0.1</li></ul><p>one can obtain the evolution of the evolution of S, I and R over time, by integrating the ODE system using a numerical scheme.</p><p><img loading="lazy" alt="Plot of SIR system integration." src="/assets/images/SIR-result-add683a40b9b3899dbdb58b964225056.png" width="1362" height="462" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-and-when-can-we-use-ode-in-agent-based-models">Why and when can we use ODE in agent-based models?<a href="#why-and-when-can-we-use-ode-in-agent-based-models" class="hash-link" aria-label="Direct link to Why and when can we use ODE in agent-based models?" title="Direct link to Why and when can we use ODE in agent-based models?">â€‹</a></h2><p>ODE models are often used when a system can be considered at a macro (population) level, i.e when the individual variability as little influence on dynamics at the aggregated level.</p><p>It is relevant to use ODE in agent-based models in several cases:</p><ul><li><p>Large scale agent-based models require many resources to run and a very large computation time. For example, if we want to implement a model describing the worldwide epidemic spread and the impact of air traffic on it, we cannot simulate the 7 billion people. Instead we can represent only cities with airports and airplanes as agents. In this case, cities are entities are represented by a compartment, on which a SIR class epidemiological model can be run, using an ODE system. Such a model combines some advantages of agent-based models (detailed description of the disease spread from one city to another with the plane agents) and mathematical modeling (good description of an epidemiological dynamics at a city level, using fewer resources and less computation time).</p></li><li><p>Some processes may be easier to manipulate at the aggregated level, for several reasons: 1) a global description of a system may turn sometimes more informative than a detailed one, 2) a detailed description may require to fit too many parameters for which there is no sufficient data, in that case it is easier to fit a global model with less parameters, and 3) when one wants to keep a low number of parameters, in order to avoid overfitting or to optimize <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion" target="_blank" rel="noopener noreferrer">Akaike Information Criterion</a>.</p></li><li><p>Some systems are better described with a continuous dynamics than with a discrete one. This is the case for many physical or biological systems (physics laws such as gravity or water dynamics, biological processes such as respiration or cell growth). Coupling ABM and ODE model allow considering individual/discrete processes along with continuous processes.</p></li><li><p>Some models already exist in an ODE version, and could be coupled to another model in Gama without having to rewrite an Agent-Based version of the model.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-of-ode-in-a-gaml-model">Use of ODE in a GAML model<a href="#use-of-ode-in-a-gaml-model" class="hash-link" aria-label="Direct link to Use of ODE in a GAML model" title="Direct link to Use of ODE in a GAML model">â€‹</a></h2><p>A stereotypical use of ODE in a GAMA agent-based model is to describe species where some agents attribute evolution is described using an ODE system.</p><p>As a consequence, the GAML language has been increased by two main concepts (as two statements):</p><ul><li>equations can be written with the <code>equation</code> statement. An <code>equation</code> block is composed of a set of <code>diff</code> statement describing the evolution of species attributes.</li><li>an equation can be numerically integrated using the <code>solve</code> statement</li></ul><p>Additionnally, Gama provides an intuitive, flexible and natural framework to build ODE models, since an ODE system may be split among several entities. For example, if there are three species (resp. agent) involved in a common dynamics, it is possible to declare each equation inside the corresponding species (resp. agent) definition. An example is shown <a href="#Split-a-system-into-several-agents">below</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defining-and-solving-an-ode-system">Defining and solving an ODE system<a href="#defining-and-solving-an-ode-system" class="hash-link" aria-label="Direct link to Defining and solving an ODE system" title="Direct link to Defining and solving an ODE system">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-an-ode-system-with-equation">Defining an ODE system with <code>equation</code><a href="#defining-an-ode-system-with-equation" class="hash-link" aria-label="Direct link to defining-an-ode-system-with-equation" title="Direct link to defining-an-ode-system-with-equation">â€‹</a></h3><p>Defining a new ODE system needs to define a new <code>equation</code> block in a species. As an example, the following <code>eqSI</code> system describes the evolution of a population with 2 compartments (S and I) and the flow from S to I compartments: </p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">userSI</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain">&lt;-</span><span class="token number" style="color:rgb(125,125,125)">0.4</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">h</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">equation</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">eqSI</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = -</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain"> / </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain"> / </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}           </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This equation has to be defined in a species with <code>t</code>, <code>S</code> and <code>I</code> attributes. <code>beta</code> (and other similar parameters) can be defined either in the specific species (if it is specific to each agent) or in the <code>global</code> if it is a constant.</p><p>Note: it is mandatory to declare a differenciation variable (here <code>t</code>) as an attribute in the species. It is automatically updated using the <code>solve</code> statement and contains the time elapsed in the equation integration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="solve-an-ode-system"><code>solve</code> an ODE system<a href="#solve-an-ode-system" class="hash-link" aria-label="Direct link to solve-an-ode-system" title="Direct link to solve-an-ode-system">â€‹</a></h2><p>Once the equation or system of equations has been defined, it is necessary to execute a <code>solve</code> statement inside a reflex in order to numerically integrate the ODE system. The reflex is executed at each cycle, and the values of the attributes used in the equations (<code>S</code> and <code>I</code> in the previous example) are updated with the values obtained by integrating the system between the start time end and end time of the current cycle.</p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">solving</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">solve</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">eqSI</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">method:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#rk</span><span class="token plain">4 </span><span class="token facet" style="color:rgb(154,72,71)">step_size:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">h</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Several numerical schemes are available to solve the ODE system. More details about the numerical schemes and the <code>solve</code> syntax are provided <a href="#More-details">below</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-way-to-define-an-ode-system">Alternative way to define an ODE system<a href="#alternative-way-to-define-an-ode-system" class="hash-link" aria-label="Direct link to Alternative way to define an ODE system" title="Direct link to Alternative way to define an ODE system">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="split-a-system-into-several-agents">Split a system into several agents<a href="#split-a-system-into-several-agents" class="hash-link" aria-label="Direct link to Split a system into several agents" title="Direct link to Split a system into several agents">â€‹</a></h3><p>An equation system can be split into several species and each part of the system are synchronized using the <code>simultaneously</code> facet of <code>equation</code>. The system split into several agents can be integrated using a single call to the <code>solve</code> statement. Notice that all the <code>equation</code> definition must have the same name.</p><p>For example, the SI system presented above can be defined in two different species <code>S_agt</code> (containing the equation defining the evolution of the S value) and <code>I_agt</code> (containing the equation defining the evolution of the I value). These two equations are linked using the <code>simultaneously</code> facet of the <code>equation</code> statement. This facet expects a set of agents. The integration is called only once in a simulation step, e.g. in the <code>S_agt</code> agent.</p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">global</span><span class="token plain"> {    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">1000</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">hRK4</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.01</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">S_agt</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain">       </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">Ssize</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">equation</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">evol</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">simultaneously:</span><span class="token plain"> [ </span><span class="token variable" style="color:rgb(28,125,180)">I_agt</span><span class="token plain"> ] {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">Ssize</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = </span><span class="token punctuation">(</span><span class="token plain">- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">sum</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">I_agt</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">accumulate</span><span class="token plain"> [</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> * </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">Isize</span><span class="token plain">]</span><span class="token punctuation">)</span><span class="token plain"> * </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">Ssize</span><span class="token plain"> / </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">solving</span><span class="token plain"> {</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">solve</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">evol</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">method:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#rk</span><span class="token plain">4 </span><span class="token facet" style="color:rgb(154,72,71)">step_size:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">hRK4</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain">}  </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">I_agt</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">Isize</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(63,127,95)">// number of infected </span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">equation</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">evol</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">simultaneously:</span><span class="token plain"> [ </span><span class="token variable" style="color:rgb(28,125,180)">S_agt</span><span class="token plain"> ] {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">Isize</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = </span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> * </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">first</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">S_agt</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">Ssize</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">Isize</span><span class="token plain"> / </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The interest is that the modeler can create several agents for each compartment, which different values. For example in the SI model, the modeler can choose to create 1 agent <code>S_agt</code> and 2 agents <code>I_agt</code>. The <code>beta</code> attribute will have different values in the two agents, in order to represent 2 different strains.</p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">global</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">number_S</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">495</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(63,127,95)">// The number of susceptible</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">number_I</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">5</span><span class="token plain">   </span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(63,127,95)">// The number of infected</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb_I</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">2</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">gbeta</span><span class="token plain">  &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.3</span><span class="token plain">  </span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(63,127,95)">// The parameter Beta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">number_S</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">nb_I</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">number_I</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">hRK4</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.1</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">init</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">create</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">S_agt</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token variable" style="color:rgb(28,125,180)">Ssize</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">float</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">number_S</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">create</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">I_agt</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">number:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">nb_I</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token variable" style="color:rgb(28,125,180)">Isize</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">float</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">number_I</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> &lt;- </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">myself</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">gbeta</span><span class="token plain"> + </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">rnd</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">0.5</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The results are computed using the RK4 (Runge-Kutta 4) method with:</p><ul><li>number_S = 495 </li><li>number_I = 5  </li><li>nb_I = 2</li><li>gbeta = 0.3 </li><li>hKR4 = 0.1 </li></ul><p><img loading="lazy" alt="SI-split-results.png" src="/assets/images/SI-split-results-5205e06f9abdbe5aefad699573f5f244.png" width="1872" height="432" class="img_ev3q"></p><p>Important note: the <code>solve</code> statement must be called once and only once per cycle. In this example, is it executed in the &#x27;solving&#x27; reflex of the only <code>S_agt</code> agent. There is no &#x27;solving&#x27; reflex in the <code>I_agt</code> agents: since the equations definitions blocks are connected through the <code>simultaneously</code> facet, there equation blocks will be integrated by the <code>S_agt</code> agent. Note also that if they were several <code>S_agt</code> agents, with the same definition of the &#x27;solving&#x27; reflex, the <code>solve</code> statement would be executed several times, which could result in wrong results. To ensure that it is called only once, the &#x27;solving&#x27; reflex should be rewritten. For example, it is possible to write this:</p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">solving</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">when:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">int</span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">)</span><span class="token plain">=</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">)</span><span class="token plain"> {</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">solve</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">evol</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">method:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#rk</span><span class="token plain">4 </span><span class="token facet" style="color:rgb(154,72,71)">step_size:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">hRK4</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain">}  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-details">More details<a href="#more-details" class="hash-link" aria-label="Direct link to More details" title="Direct link to More details">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="details-about-the-solve-statement">Details about the <code>solve</code> statement<a href="#details-about-the-solve-statement" class="hash-link" aria-label="Direct link to details-about-the-solve-statement" title="Direct link to details-about-the-solve-statement">â€‹</a></h3><p>The <code>solve</code> statement can have a huge set of facets (see <a href="/wiki/next/Statements#solve">this page</a> for more details). The basic use of the <code>solve</code> statement requires only the equation identifier. By default, the integration method is Runge-Kutta 4 with a fixed integration step of <code>0.005*step</code>, which means that each simulation step (cycle) is divided into 200 smaller integration steps that are used to simulate a continuous evolution of the system.</p><p>For fixed integration step numerical schemes such as Runge-Kutta 4, the length of the integration step is defined in the <code>step_size</code> facet. Increasing the integration step results in faster computation at the cost of accuracy.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="integration-method-with-the-method-facet">Integration method with the <code>method</code> facet<a href="#integration-method-with-the-method-facet" class="hash-link" aria-label="Direct link to integration-method-with-the-method-facet" title="Direct link to integration-method-with-the-method-facet">â€‹</a></h4><p>Several integration methods can be used in the <code>method</code> facet. GAMA relies on the <a href="http://commons.apache.org/math/" target="_blank" rel="noopener noreferrer">Apache Commons Math library</a> to provide numerical schemes; it thus provides access to the various solvers integrated into the library. The list of all the solver is detailed <a href="http://commons.apache.org/proper/commons-math/userguide/ode.html" target="_blank" rel="noopener noreferrer">in this page, section 15.4 Available integrators</a>. The GAML constants associated with each of them (to use in the <code>method</code> statement) are:
)</p><ul><li>Fixed Step Integrators<ul><li><code>#Euler</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/EulerIntegrator.html" target="_blank" rel="noopener noreferrer">Euler</a>. It implements <a href="https://en.wikipedia.org/wiki/Euler_method" target="_blank" rel="noopener noreferrer">the Euler integration method</a>, which is mainly used for academic illustration of numerical schemes. It should not be used outside of this purpose due to its lack of precision (a very small integration step is required for an acceptable precision).</li><li><code>#Midpoint</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/MidpointIntegrator.html" target="_blank" rel="noopener noreferrer">Midpoint</a></li><li><code>#rk4</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/ClassicalRungeKuttaIntegrator.html" target="_blank" rel="noopener noreferrer">Runge-Kutta 4</a>. It implements <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods" target="_blank" rel="noopener noreferrer">the Runge-Kutta 4 integration method</a>. It provides a faster convergence than the Euler method, and thus does not require very small integration steps. However the user has to determine manually the ideal integration step. For that reason, it is recommended to try first an adaptative stepsize integrator such as the Dorman-Prince 5(4) integration method.</li><li><code>#Gill</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/GillIntegrator.html" target="_blank" rel="noopener noreferrer">Gill</a></li><li><code>#ThreeEighthes</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/ThreeEighthesIntegrator.html" target="_blank" rel="noopener noreferrer">3/8</a></li><li><code>#Luther</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/LutherIntegrator.html" target="_blank" rel="noopener noreferrer">Luther</a></li></ul></li><li>Adaptive Stepsize Integrators<ul><li><code>#HighamHall54</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/HighamHall54Integrator.html" target="_blank" rel="noopener noreferrer">Higham and Hall</a></li><li><code>#DormandPrince54</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/DormandPrince54Integrator.html" target="_blank" rel="noopener noreferrer">Dormand-Prince 5(4)</a> It implements <a href="https://en.wikipedia.org/wiki/Dormand%E2%80%93Prince_method" target="_blank" rel="noopener noreferrer">the Dorman-Prince 5(4) integration method</a>. It is similar to the <code>ode45</code>in Matlab. This method is based on the Runge-Kutta solvers family. It evaluates the error between the numerical solution and the analytic solution, and adapt the integration step in order to minimize it. It is recommended to try this method first, even it may not the best one in case of <a href="https://en.wikipedia.org/wiki/Stiff_equation" target="_blank" rel="noopener noreferrer">stiff problems</a>.</li><li><code>#dp853</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/DormandPrince853Integrator.html" target="_blank" rel="noopener noreferrer">Dormand-Prince 8(5,3)</a>. </li><li><code>#GraggBulirschStoer</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/GraggBulirschStoerIntegrator.html" target="_blank" rel="noopener noreferrer">Gragg-Bulirsch-Stoer</a></li><li><code>#AdamsBashforth</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/AdamsBashforthIntegrator.html" target="_blank" rel="noopener noreferrer">Adams-Bashforth</a></li><li><code>#AdamsMoulton</code> for <a href="http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math4/ode/nonstiff/AdamsMoultonIntegrator.html" target="_blank" rel="noopener noreferrer">Adams-Moulton</a></li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="integration-steps">Integration steps<a href="#integration-steps" class="hash-link" aria-label="Direct link to Integration steps" title="Direct link to Integration steps">â€‹</a></h4><p>The length of the integration step has a huge impact on precision: a smaller integration step means more evaluation points, which results in a better precision but a longer computation time. In order to improve the precision of the integration or its speed, the integration step can be set using the <code>step_size</code> facet for fixed steps methods.</p><ul><li><code>step_size</code> (float): integration step, use with most fixed steps integrator methods (default value: <code>0.005*step</code>)</li></ul><p>Adaptative stepsize integrators (e.g. <code>#DormandPrince54</code>) automatically determine and set the integration step according to a given error tolerance.
Some of them also use different integration steps all over the computation, since parts of the solution that are stable enough do not require a very small integration step, while parts with high variations need more precision. Such integrators require thus more information, through the following mandatory facets:</p><ul><li><code>min_step</code>, <code>max_step</code> (float): these 2 values define the range of variation for the integration step. As an example, we can use: <code>min_step:0.01 max_step:0.1</code>.</li><li><code>scalAbsoluteTolerance</code> and <code>scalRelativeTolerance</code> (float): they defined the allowed absolute (resp. relative) error. As an example, we can use: <code>scalAbsoluteTolerance:0.0001 scalRelativeTolerance:0.0001</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="synchronization-between-simulation-and-integration">Synchronization between simulation and integration<a href="#synchronization-between-simulation-and-integration" class="hash-link" aria-label="Direct link to Synchronization between simulation and integration" title="Direct link to Synchronization between simulation and integration">â€‹</a></h4><p><strong>The simulation and the integration are synchronized</strong>: if one simulation step represents 1 second, then one call of the <code>solve</code> statement will integrate over 1s in the ODE system. This means that the <code>step</code> attribute of the <code>global</code> has an impact on the integration. See below to observe this influence. </p><p>It is thus important to specify the unit of the parameters used in the ODE system (in particular relatively to time).</p><p>It is also important to notice that the integration step <code>step_size</code> will only control the precision of the integration. If <code>step</code> (of the <code>global</code>) is <code>1#s</code>, then after 1 call of <code>solve</code>, <code>1#s</code> has flowed in the equation system. If <code>step_size</code> is set to <code>1#s</code> or to <code>0.01#s</code> will not impact this fact. The only difference is that in the latter case, the solver made 100x more computations than in the former one (increasing the precision of the final result).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="additional-facets">Additional facets<a href="#additional-facets" class="hash-link" aria-label="Direct link to Additional facets" title="Direct link to Additional facets">â€‹</a></h4><p>Here are additional facets that be added to the <code>solve</code> statement:</p><ul><li><code>t0</code> (float): the first bound of the integration interval (default value: cycle*step, the time at the beginning of the current cycle.)</li><li><code>tf</code> (float): the second bound of the integration interval. Can be smaller than t0 for a backward integration (default value: cycle*step, the time at the beginning of the current cycle.)</li></ul><p>This might be useful more model coupling, when the sytem to integrate is not linked to the time evolution of the main simulation.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="intermediate-results">Intermediate results<a href="#intermediate-results" class="hash-link" aria-label="Direct link to Intermediate results" title="Direct link to Intermediate results">â€‹</a></h4><p>In one simulation step, if the statement <code>solve</code> is called one time, several integration steps will be done internally. Intermediate computation results can be accessed using the notation: <code>var[]</code> that returns the list of intermediate values of the variable <code>var</code> involved in a differential equation. As an example, with a SIR equation:</p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">agent_with_SIR_dynamic</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">1500</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">iInit</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">1</span><span class="token punctuation">;</span><span class="token plain">     </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token plain"> - </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">float</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">iInit</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">          </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">float</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">iInit</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">R</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.0</span><span class="token punctuation">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">alpha</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.2</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">min:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">0.0</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">max:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">1.0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.8</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">min:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">0.0</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">max:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">1.0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">float </span><span class="token variable" style="color:rgb(28,125,180)">h</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0.01</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">   </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">equation</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">SIR</span><span class="token plain">{ </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = </span><span class="token punctuation">(</span><span class="token plain">- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain"> / </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = </span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">beta</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain"> / </span><span class="token variable" style="color:rgb(28,125,180)">N</span><span class="token punctuation">)</span><span class="token plain"> - </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">alpha</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">diff</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">R</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token punctuation">)</span><span class="token plain"> = </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">alpha</span><span class="token plain"> * </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">  </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">solving</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">solve</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">SIR</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">method:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#rk</span><span class="token plain">4 </span><span class="token facet" style="color:rgb(154,72,71)">step_size:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">h</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">write</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain">[]</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">write</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain">[]</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">write</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">R</span><span class="token plain">[]</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">write</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token plain">[]</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }  </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can use <code>S[]</code>, <code>I[]</code>, <code>R[]</code> and <code>t[]</code> to access the list of intermediate variables of these 4 variables. Since<code>S[]</code> is a list the first element can be accessed with <code>S[][0]</code>. </p><p>Note that the current value of a variable, i.e. <code>S</code>, equals to the last value of the list <code>S[]</code>: <code>S</code> = <code>last(S[])</code>.</p><p>Accessing the intermediate values can be useful to provide smooth continuous charts. A way to do so is to provide the display with the full list of integration times and values, such as:</p><div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">experiment</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">continuous_display</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">type:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">gui</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">output</span><span class="token plain"> {    </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">display</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">display_charts</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">axes:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">            </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">chart</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&#x27;SIR&#x27;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">type:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">series</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">x_serie:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">first</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">agent_with_SIR_dynamic</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">t</span><span class="token plain">[] </span><span class="token facet" style="color:rgb(154,72,71)">y_range:</span><span class="token plain"> {</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(125,125,125)">1000</span><span class="token plain">} </span><span class="token facet" style="color:rgb(154,72,71)">background:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#white</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">                </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">data</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;S&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">value:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">first</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">agent_with_SIR_dynamic</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">S</span><span class="token plain">[] </span><span class="token facet" style="color:rgb(154,72,71)">color:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#green</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">marker:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">                </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">data</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;I&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">value:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">first</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">agent_with_SIR_dynamic</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">I</span><span class="token plain">[] </span><span class="token facet" style="color:rgb(154,72,71)">color:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#red</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">marker:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">                </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">data</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;R&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">value:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">first</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">agent_with_SIR_dynamic</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">R</span><span class="token plain">[] </span><span class="token facet" style="color:rgb(154,72,71)">color:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#blue</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">marker:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following picture illustrates the result: the top subfigure shows the dynamics with discrete visualization and the bottom one the continuous curves.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/18676913/167254903-a4f439f2-7474-4759-84f6-40381e900ccb.png" alt="image" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-of-the-influence-of-the-integration-step">Example of the influence of the integration step<a href="#example-of-the-influence-of-the-integration-step" class="hash-link" aria-label="Direct link to Example of the influence of the integration step" title="Direct link to Example of the influence of the integration step">â€‹</a></h3><p>The <code>step</code> (of the <code>global</code>) and <code>step_size (of </code>solve) facets may have a huge influence on the results. <code>step_size</code> only has an impact on the result accuracy. The <code>step</code> facet changes the cycle duration and so the time scale and results in curves being horizontally scales.</p><p>In the following image, the <code>step</code>facet has been change from 1.0 (first simulation) to 2.0 (second simulation). The dynamics are exactly the same, but they are viewed at different time scales.</p><p>The following image illustrates this impact, by calling (with 3 different values of <code>step)</code>:</p><p><img loading="lazy" alt="Impact of the `step` of the simulation on an ODE integration." src="/assets/images/SIR-results-step-influence-b9a666fd57dd78f97006b7bbe17ed20f.png" width="2348" height="1742" class="img_ev3q"></p><p>When changing this facet, be sure that the time scale of the ODE system remains consistent with the one of the other agents.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gama-platform/gama/wiki/DifferentialEquations/_edit" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/wiki/next/ControlArchitecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Control Architectures</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/wiki/next/Recipes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Recipes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#example-of-a-sir-model" class="table-of-contents__link toc-highlight">Example of a SIR model</a></li><li><a href="#why-and-when-can-we-use-ode-in-agent-based-models" class="table-of-contents__link toc-highlight">Why and when can we use ODE in agent-based models?</a></li><li><a href="#use-of-ode-in-a-gaml-model" class="table-of-contents__link toc-highlight">Use of ODE in a GAML model</a></li><li><a href="#defining-and-solving-an-ode-system" class="table-of-contents__link toc-highlight">Defining and solving an ODE system</a><ul><li><a href="#defining-an-ode-system-with-equation" class="table-of-contents__link toc-highlight">Defining an ODE system with <code>equation</code></a></li></ul></li><li><a href="#solve-an-ode-system" class="table-of-contents__link toc-highlight"><code>solve</code> an ODE system</a></li><li><a href="#alternative-way-to-define-an-ode-system" class="table-of-contents__link toc-highlight">Alternative way to define an ODE system</a><ul><li><a href="#split-a-system-into-several-agents" class="table-of-contents__link toc-highlight">Split a system into several agents</a></li></ul></li><li><a href="#more-details" class="table-of-contents__link toc-highlight">More details</a><ul><li><a href="#details-about-the-solve-statement" class="table-of-contents__link toc-highlight">Details about the <code>solve</code> statement</a></li><li><a href="#example-of-the-influence-of-the-integration-step" class="table-of-contents__link toc-highlight">Example of the influence of the integration step</a></li></ul></li></ul></div></div></div><br></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://github.com/gama-platform" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i> Github <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.facebook.com/GamaPlatform/" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook"></i> Facebook <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.linkedin.com/company/gama-platform" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin"></i> LinkedIn <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.youtube.com/channel/UCWJ1kWGDDI-9u2f2uD0gcaQ" target="_blank" rel="noopener noreferrer"><i class="fab fa-youtube"></i> Youtube <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://gama-platform.org/blog/rss.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss"></i> Blog RSS <i class="fa fa-arrow-up-right-from-square"></i></a></li></ul></div><div class="col footer__col"><div class="footer__title">Mailing list</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://groups.google.com/forum/#!forum/gama-platform" target="_blank"><i class="fas fa-envelope"></i> For Users<br>gama-platform@googlegroups.com</a></li><li class="footer__item"><a class="footer__link-item" href="https://groups.google.com/forum/#!forum/gama-dev" target="_blank"><i class="fas fa-envelope"></i> For Developers<br>gama-dev@googlegroups.com</a></li></ul></div><div class="col footer__col"><div class="footer__title">Licence</div><ul class="footer__items clean-list"><li class="footer__item">
                  <p>
                    Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
                  </p>
                </li><li class="footer__item">
                  <p>A copy of the license is included <a href="https://github.com/gama-platform/gama/wiki/LICENSE.md" style="display:initial">here</a>, in the repository of the wiki content.</p>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/gama-logo.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/gama-logo.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright (C) - 2023 GAMA Platform.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2b69a667.js"></script>
<script src="/assets/js/main.75fc2077.js"></script>
</body>
</html>