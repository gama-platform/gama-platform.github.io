# gama-platform.github.io

Gama Platform website under github.io uses different tools : 
  * [Jekyll](https://jekyllrb.com/), a powerfull static-pages website generator,
  * [Github-pages](https://pages.github.com/), a website hosting service proposed by Github for a repository,
  * [Node JS](https://nodejs.org/en/), a JavaScript runtime built on Chrome JavaScript engine,
  * [LunrJS](https://lunrjs.com/), a client-sided searching tools using JavaScript,
  * [Travis](https://travis-ci.org/), a website to test and deploy applications
## Content of the Repository
You should find the different folders : 
  * **_includes**, containing different pages that will be included by other pages such as style.html, containing all the CSS importations and menu.html, containing the HTML of the top menu but also everything related to the search tools
  * **_layouts**, containing the different layouts used as template for the pages of the website. A layout is something used by Jekyll as a template for pages, a page can use a certain layout by filling the layout field at the top of the page, in the YAML header
  * **_plugins**, containing the different Ruby plug-ins used by the website (however, plug-ins are not accepted at the moment by Github-pages)
  * **_posts**, containing the different posts that are displayed in the "News" page of the website. They must be written in the format YYYY-MM-DD-TITLE.md
  * **_scripts**, containing the different scripts used by Travis to generate the website and the indexes
  * **_site**, containing the website generated by Jekyll, the content of this folder is the result of all the processes done, and is the one displayed by github-pages to the readers
  * **_wiki**, containing the clone repository of the wiki of the github, found at the page [wiki](https://github.com/gama-platform/gama/wiki)
  * **css**, containing the different CSS files used by the website
  * **fonts**, containing the font-awesome package
  * **images**, containing the different images used by the website (images appearing in the "wiki" folder, "References" and "Tutorials" pages are not here, but in "resources" folder)
  * **indexes**, containing the different indexes generated by the Rakefile used to do search on the website by LunrJS
  * **js**, containing the JavaScript used in the website,
  * **node_modules**, containing everything related to the Node JS and LunrJS module
  * **resources**, containing the resources used in the [wiki](https://github.com/gama-platform/gama/wiki) : images, icons.
  * **wiki**, the wiki folder, that should contain nothing since it is cleaned after each processing

*All the folders beginning with "_" are folders not taken by Jekyll to appears in the "_site" folder.* 

Different files should appears, but the most importants ones are :
  * **_config.yml**, file containing the configuration of Jekyll
  * **.travis.yml**, file containing the configuration of Travis
  * **Gemfile**, file containing the different dependencies of Ruby
  * **Rakefile.rb**, file containing the script to create a local repo of the [wiki](https://github.com/gama-platform/gama/wiki), update the contents of the website accordingly and generate the indexes while looping through the different files of the wiki (Operators, Statements, etc.)
## Adding the repository to do changes locally
Assuming that all the required softwares (see at the top of the page) have been installed, you need to clone this repository to your computer. Open your terminal and go to the root folder of your repository. 
You might need to do a ```bundle install```and ```bundle update``` command to update your Ruby Bundle. 
You can build the website locally by typing the command ```rake wiki```, updating the content of the "_wiki" folder from the [wiki](https://github.com/gama-platform/gama/wiki) repository, changing the links, building the JSON files used for indexing the pages.
Once the website built, you can launch the server by typing ```bundle exec jekyll serve```.
If you did any change in the "Rakefile.rb" or the scripts and you want to commit them, feel free to do so. However, any changes done in the folder "_wiki" or "wiki" will not have any effects since it is changed using scripts. If you need to do changes in the wiki, do it in the wiki directly to the repository [here](https://github.com/gama-platform/gama/wiki) but not in the folder "wiki" or "_wiki" of this repository.

## Workflow of Travis
Travis will do different tasks after a commit before validating it. The first one is to do the script "install_for_indexing.sh" that will install different dependencies to the VM of Travis. 
Once that script is done, it will execute the ```rake wiki``` command to update all the contents of the wiki and documentation of the website according to the repository [here](https://github.com/gama-platform/gama/wiki). This command will also build the different lunr.XXXXX.json files for indexing the pages. 
If the previous command is a success, different scripts will be done : one to generate the index_xxxxx.json files using the lunr.XXXXX.json files generated previously, and one to commmit everything to the repository.
