"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[15276],{94080:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>o});var t=i(17624),r=i(4552);const s={title:"Headless Mode"},a=void 0,l={id:"Headless",title:"Headless Mode",description:"The aim of this feature is to be able to run one or multiple instances of GAMA without any user interface so that models and experiments can be launched on a grid or a cluster. Without GUI, the memory footprint, as well as the speed of the simulations, are usually greatly improved.",source:"@site/versioned_docs/version-1.8.1/Headless.md",sourceDirName:".",slug:"/Headless",permalink:"/wiki/1.8.1/Headless",draft:!1,unlisted:!1,editUrl:"https://github.com/gama-platform/gama/wiki/Headless/_edit",tags:[],version:"1.8.1",frontMatter:{title:"Headless Mode"},sidebar:"main",previous:{title:"Launching GAMA",permalink:"/wiki/1.8.1/Launching"},next:{title:"Updating GAMA",permalink:"/wiki/1.8.1/Updating"}},d={},o=[{value:"Table of contents",id:"table-of-contents",level:2},{value:"Command",id:"command",level:2},{value:"Bash Script",id:"bash-script",level:3},{value:"Java Command",id:"java-command",level:3},{value:"Experiment Input File",id:"experiment-input-file",level:2},{value:"Heading",id:"heading",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Outputs",id:"outputs",level:3},{value:"Output Directory",id:"output-directory",level:2},{value:"Simulation Output",id:"simulation-output",level:2},{value:"Step",id:"step",level:3},{value:"Variable",id:"variable",level:3},{value:"Snapshot files",id:"snapshot-files",level:2}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.M)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"The aim of this feature is to be able to run one or multiple instances of GAMA without any user interface so that models and experiments can be launched on a grid or a cluster. Without GUI, the memory footprint, as well as the speed of the simulations, are usually greatly improved."}),"\n",(0,t.jsxs)(n.p,{children:["In this mode, GAMA can only be used to run experiments and that editing or managing models is not possible. In order to launch experiments and still benefit from a user interface (which can be used to prepare headless experiments), launch GAMA normally (see ",(0,t.jsx)(n.a,{href:"Launching",children:"here"}),") and refer to this ",(0,t.jsx)(n.a,{href:"RunningExperiments",children:"page"})," for instructions."]}),"\n",(0,t.jsx)(n.h2,{id:"table-of-contents",children:"Table of contents"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#headless-mode",children:"Headless Mode"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#command",children:"Command"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#bash-script",children:"Bash Script"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#java-command",children:"Java Command"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#experiment-input-file",children:"Experiment Input File"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#heading",children:"Heading"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#parameters",children:"Parameters"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#outputs",children:"Outputs"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#output-directory",children:"Output Directory"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#simulation-output",children:"Simulation Output"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#step",children:"Step"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#variable",children:"Variable"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#snapshot-files",children:"Snapshot files"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"command",children:"Command"}),"\n",(0,t.jsx)(n.p,{children:"There are two ways to run a GAMA experiment in headless mode: using a dedicated shell script (recommended) or directly from the command line. These commands take 2 arguments: a file describing the experiment plan to run and an output directory."}),"\n",(0,t.jsx)(n.h3,{id:"bash-script",children:"Bash Script"}),"\n",(0,t.jsxs)(n.p,{children:["It can be found in the ",(0,t.jsx)(n.code,{children:"headless"})," directory located inside ",(0,t.jsx)(n.code,{children:"Gama"}),". Its name is ",(0,t.jsx)(n.code,{children:"gama-headless.sh"})," on MacOSX and Linux, and ",(0,t.jsx)(n.code,{children:"gama-headless.bat"})," on Windows."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:" bash gama-headless.sh [m/c/t/hpc/v] $1 $2\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"with:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"$1 input parameter file : an xml file determining experiment parameters and attended outputs"}),"\n",(0,t.jsx)(n.li,{children:"$2 output directory path : a directory which contains simulation results (numerical data and simulation snapshot)"}),"\n",(0,t.jsxs)(n.li,{children:["options [-m/c/t/hpc/v]","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"-m memory : memory allocated to gama"}),"\n",(0,t.jsx)(n.li,{children:"-c : console mode, the simulation description could be written with the stdin"}),"\n",(0,t.jsx)(n.li,{children:"-t : tunneling mode, simulation description are read from the stdin, simulation results are printed out in stdout"}),"\n",(0,t.jsx)(n.li,{children:"-hpc nb_of_cores : allocate a specific number of cores for the experiment plan"}),"\n",(0,t.jsx)(n.li,{children:"-v : verbose mode. trace are displayed in the console"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["For example (using the provided sample), navigate in your terminal to the ",(0,t.jsx)(n.code,{children:"headless"})," folder inside your GAMA root folder and type:"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"bash gama-headless.sh samples/predatorPrey.xml outputHeadLess\n"})}),"\n",(0,t.jsxs)(n.p,{children:["As specified in ",(0,t.jsx)(n.strong,{children:"predatorPrey.xml"}),", this command runs the prey - predator model for 1000 steps and record a screenshot of the main display every 5 steps. The screenshots are recorded in the directory ",(0,t.jsx)(n.code,{children:"outputHeadLess"})," (under the GAMA root folder)."]}),"\n",(0,t.jsx)(n.p,{children:"Note that the current directory to run gama-headless command must be $GAMA_PATH/headless"}),"\n",(0,t.jsx)(n.h3,{id:"java-command",children:"Java Command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"java -cp $GAMA_CLASSPATH -Xms512m -Xmx2048m -Djava.awt.headless=true org.eclipse.core.launcher.Main -application msi.gama.headless.id4 $1 $2\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["with:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"$GAMA_CLASSPATH GAMA classpath: contains the relative or absolute path of jars inside the GAMA plugin directory and jars created by users"}),"\n",(0,t.jsx)(n.li,{children:"$1 input parameter file: an XML file determining experiment parameters and attended outputs"}),"\n",(0,t.jsx)(n.li,{children:"$2 output directory path: a directory which contains simulation results (numerical data and simulation snapshot)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Note that the output directory is created during the experiment and should not exist before."}),"\n",(0,t.jsx)(n.h2,{id:"experiment-input-file",children:"Experiment Input File"}),"\n",(0,t.jsx)(n.p,{children:"The XML input file contains for example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'<?xml version="1.0" encoding="UTF-8"?>\n<Experiment_plan>\n <Simulation id="2" sourcePath="./predatorPrey/predatorPrey.gaml" finalStep="1000" until="length(predator) = 1"  \n experiment="predPrey">\n  <Parameters>\n    <Parameter name="nb_predator_init" type="INT" value="53" />\n    <Parameter name="nb_preys_init" type="INT" value="621" />\n  </Parameters>\n  <Outputs>\n    <Output id="1" name="main_display" framerate="10" />\n    <Output id="2" name="number_of_preys" framerate="1" />\n    <Output id="3" name="number_of_predators" framerate="1" />\n    <Output id="4" name="duration" framerate="1" />\n  </Outputs>\n </Simulation>\n</Experiment_plan>\n'})}),"\n",(0,t.jsx)(n.p,{children:"Note that several simulations could be determined in one experiment plan. These simulations are run in parallel according to the number of allocated cores."}),"\n",(0,t.jsx)(n.h3,{id:"heading",children:"Heading"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'<Simulation id="2" sourcePath="./predatorPrey/predatorPrey.gaml" finalStep="1000" until="length(predator) = 1"  \n experiment="predPrey">\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["with:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"id"}),": permits to prefix output files for experiment plan with huge simulations."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sourcePath"}),": contains the relative or absolute path to read the gaml model."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"finalStep"}),": determines the number of simulation step you want to run."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"until"}),": defines a stop condition. It can be combined with the ",(0,t.jsx)(n.code,{children:"finalStep"})," facet (in this case a simulation when the stop condition is fulfilled or when the final step is reached."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"experiment"}),": determines which experiment should be run on the model. This experiment should exist, otherwise, the headless mode will exit."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsx)(n.p,{children:"One line per parameter you want to specify a value to:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'<Parameter name="nb_predator_init" type="INT" value="53" />\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["with:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"}),":  name of the parameter in the gaml model"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"}),":  type of the parameter (INT, FLOAT, BOOLEAN, STRING)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"value"}),": the chosen value"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"outputs",children:"Outputs"}),"\n",(0,t.jsx)(n.p,{children:"One line per output value you want to retrieve. Outputs can be names of monitors or displays defined in the 'output' section of experiments, or the names of attributes defined in the experiment or the model itself (in the 'global' section)."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'    ... with the name of a monitor defined in the \'output\' section of the experiment...\n    <Output id="2" name="number_of_preys" framerate="1" />\n    ... with the name of a (built-in) variable defined in the experiment itself...\n    <Output id="4" name="duration" framerate="1" />\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"with:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"}),": name of the output in the 'output'/'permanent' section in the experiment or name of the experiment/model attribute to retrieve"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"framerate"}),": the frequency of the monitoring (each step, every 2 steps, every 100 steps...)."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Note that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"the lower the framerate value the longer the experiment."}),"\n",(0,t.jsx)(n.li,{children:"if the chosen output is a display, an image is produced and the output file contains the path to access this image"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"output-directory",children:"Output Directory"}),"\n",(0,t.jsx)(n.p,{children:"During headless experiments, a directory is created with the following structure:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Outputed-directory-path/\n    |-simulation-output.xml\n    |- snapshot\n          |- main_display2-0.png\n          |- main_display2-10.png\n          |- ...\n\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["with:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"simulation-output.xml"}),": containing the results"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"snapshot"}),": containing the snapshots produced during the simulation"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:'Is it possible to change the output directory for the images by adding the attribute "output_path" in the xml :'}),"\n",(0,t.jsxs)(n.p,{children:["If we write ",(0,t.jsx)(n.code,{children:'<Output id="1" name="my_display" file:"/F:/path/imageName" framerate="10" />'}),', then the display "my_display" will have the name "imageName-stepNb.png" and will be written in the folder "/F:/path/"']}),"\n",(0,t.jsx)(n.h2,{id:"simulation-output",children:"Simulation Output"}),"\n",(0,t.jsxs)(n.p,{children:["A file named ",(0,t.jsx)(n.code,{children:"simulation-output.xml"})," is created with the following contents when the experiment runs."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Simulation id=\"2\" >\n\t<Step id='0' >\n\t\t<Variable name='main_display' value='main_display2-0.png'/>\n\t\t<Variable name='number_of_preys' value='613'/>\n\t\t<Variable name='number_of_predators' value='51'/>\n                <Variable name='duration' value='6' />\n\t</Step>\n\t<Step id='1' >\n\t\t<Variable name='main_display' value='main_display2-0.png'/>\n\t\t<Variable name='number_of_preys' value='624'/>\n\t\t<Variable name='number_of_predators' value='51'/>\n                <Variable name='duration' value='5' />\n\t</Step>\n        <Step id='2'>\n\n...\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["With:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'<Simulation id="2" >'}),": block containing results of the simulation 2 (this Id is identified in the Input Experiment File)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"<Step id='1' > ... </Step>"}),": one block per step done. The id corresponds to the step number"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"step",children:"Step"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\t<Step id='1' >\n\t\t<Variable name='main_display' value='main_display2-0.png'/>\n\t\t<Variable name='number_of_preys' value='624'/>\n\t\t<Variable name='number_of_predators' value='51'/>\n                <Variable name='duration' value='6' />\n\t</Step>\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"There is one Variable block per Output identified in the output experiment file."}),"\n",(0,t.jsx)(n.h3,{id:"variable",children:"Variable"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:" <Variable name='main_display' value='main_display2-0.png'/>\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["with:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"}),": name of the output, the model variable"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"value"}),": the current value of the model variable."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Note that the value of an output is repeated according to the framerate defined in the input experiment file."}),"\n",(0,t.jsx)(n.h2,{id:"snapshot-files",children:"Snapshot files"}),"\n",(0,t.jsx)(n.p,{children:"This directory contains images generated during the experiment. There is one image per displayed output per step (according to the framerate). File names follow a naming convention, e.g:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"   [outputName][SimulationID]_[stepID].png -> main_display2-20.png\n"})}),"\n",(0,t.jsx)(n.p,{children:"Note that images are saved in '.png' format."})]})}function c(e={}){const{wrapper:n}={...(0,r.M)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},4552:(e,n,i)=>{i.d(n,{I:()=>l,M:()=>a});var t=i(11504);const r={},s=t.createContext(r);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);