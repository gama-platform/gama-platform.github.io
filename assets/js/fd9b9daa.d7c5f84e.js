"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[69199],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>h});var i=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=i.createContext({}),c=function(e){var n=i.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return i.createElement(l.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(t),d=a,h=p["".concat(l,".").concat(d)]||p[d]||m[d]||r;return t?i.createElement(h,o(o({ref:n},u),{},{components:t})):i.createElement(h,o({ref:n},u))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,o=new Array(r);o[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[p]="string"==typeof e?e:a,o[1]=s;for(var c=2;c<r;c++)o[c]=t[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},84079:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>p});var i=t(87462),a=t(63366),r=(t(67294),t(3905)),o=["components"],s={title:"Defining user interaction"},l=void 0,c={unversionedId:"DefiningUserInteraction",id:"DefiningUserInteraction",title:"Defining user interaction",description:"[//]: # (keyword|concept_gui)",source:"@site/../docs/DefiningUserInteraction.md",sourceDirName:".",slug:"/DefiningUserInteraction",permalink:"/wiki/next/DefiningUserInteraction",draft:!1,editUrl:"https://github.com/gama-platform/gama/wiki/DefiningUserInteraction/_edit",tags:[],version:"current",frontMatter:{title:"Defining user interaction"},sidebar:"main",previous:{title:"Defining export files",permalink:"/wiki/next/DefiningExportFiles"},next:{title:"Exploring Models",permalink:"/wiki/next/ExploringModels"}},u={},p=[{value:"Index",id:"index",level:2},{value:"Catch Mouse Event",id:"catch-mouse-event",level:2},{value:"Define User command",id:"define-user-command",level:2},{value:"Defining User command in GUI Experiment scope",id:"defining-user-command-in-gui-experiment-scope",level:3},{value:"Defining User command in a global or regular species",id:"defining-user-command-in-a-global-or-regular-species",level:3},{value:"user_location",id:"user_location",level:3},{value:"user_input",id:"user_input",level:3},{value:"User Control Architecture",id:"user-control-architecture",level:2}],m={toc:p},d="wrapper";function h(e){var n=e.components,s=(0,a.Z)(e,o);return(0,r.kt)(d,(0,i.Z)({},m,s,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"During the simulation, GAML provides you the possibility to define some function the user can execute during the execution. In this chapter, we will see how to define buttons to execute action during the simulation, how to catch click event, and how to use the user control architecture."),(0,r.kt)("h2",{id:"index"},"Index"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#catch-mouse-event"},"Catch Mouse Event")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#define-user-command"},"Define User command"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#defining-user-command-in-gui-experiment-scope"},"... in the GUI Experiment scope")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#defining-user-command-in-a-global-or-regular-species"},"... in global or regular species")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#user_location"},"user_location")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#user_input"},"user_input")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#user-control-architecture"},"User Control Architecture"))),(0,r.kt)("h2",{id:"catch-mouse-event"},"Catch Mouse Event"),(0,r.kt)("p",null,"You can catch mouse event during the simulation using the statement ",(0,r.kt)("inlineCode",{parentName:"p"},"event"),". This statement has 2 required facets:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"name"))," (identifier) : Specify which event do you want to trigger (among the following values : ",(0,r.kt)("inlineCode",{parentName:"li"},"mouse_down"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"mouse_up"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"mouse_move"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"mouse_enter"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"mouse_exit")," or any alphanumeric symbol/key of the keyboard, such as, ",(0,r.kt)("inlineCode",{parentName:"li"},"'a'"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"'b'"),"...)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"action"))," (identifier) : Specify the name of the global action to call.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"event mouse_down action: my_action;\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"event")," statement has to be defined in the ",(0,r.kt)("inlineCode",{parentName:"p"},"experiment"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"output"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"display")," scope. Once the event is triggered, the global action linked will be called. The action linked cannot have arguments. To get the location of the mouse click, the ",(0,r.kt)("inlineCode",{parentName:"p"},"#user_location")," can be used; to get the agents on which the mouse has clicked, you can use spatial query (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"my_species overlapping #user_location"),")."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'global\n{\n    action my_action\n    {\n        write "do action";\n    }\n\n}\n\nspecies my_species\n{\n}\n\nexperiment my_experiment type: gui\n{\n    output\n    {\n        display my_display\n        {\n            species my_species;\n            event mouse_down action: my_action;\n        }\n    }\n}\n')),(0,r.kt)("h2",{id:"define-user-command"},"Define User command"),(0,r.kt)("p",null,"Anywhere in the global block, in a species or in an (GUI) experiment, ",(0,r.kt)("inlineCode",{parentName:"p"},"user_command")," statements can be implemented. They can either call directly an existing action (with or without arguments) or be followed by a block that describes what to do when this command is run."),(0,r.kt)("p",null,"Their syntax can be (depending of the modeler needs) either:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"user_command cmd_name action: action_without_arg_name;\n//or\nuser_command cmd_name action: action_name with: [arg1::val1, arg2::val2];\n//or\nuser_command cmd_name {\n   // statements\n}\n")),(0,r.kt)("p",null,"For instance:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"user_command kill_myself action: die;\n//or\nuser_command kill_myself action: some_action with: [arg1::5, arg2::3];\n//or\nuser_command kill_myself {\n    do die;\n}\n")),(0,r.kt)("h3",{id:"defining-user-command-in-gui-experiment-scope"},"Defining User command in GUI Experiment scope"),(0,r.kt)("p",null,"The user command can be defined directly inside the GUI experiment scope. In that case, the implemented action appears as a button in the top of the parameter view."),(0,r.kt)("p",null,"Here is a very short code example :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"model quick_user_command_model\n\nglobal {\n    action createAgent\n    {\n        create my_species;\n    }\n}\n\nspecies my_species {\n    aspect base {\n        draw circle(1) color:#blue;\n    }\n}\n\nexperiment expe type:gui {\n    user_command cmd_inside_experiment action:createAgent;\n    output {\n        display my_display {\n            species my_species aspect:base;\n        }\n    }\n}\n")),(0,r.kt)("p",null,"And here is screenshots of the execution :"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"images/user_command_inside_expe.png",src:t(982).Z,width:"1144",height:"698"})),(0,r.kt)("h3",{id:"defining-user-command-in-a-global-or-regular-species"},"Defining User command in a global or regular species"),(0,r.kt)("p",null,"The user command can also be defined inside a species scope (either global or regular one). Here is a quick example of model :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"model quick_user_command_model\n\nglobal {\n    init {\n        create my_species number:10;\n    }\n}\n\nspecies my_species {\n    user_command cmd_inside_experiment action:die;\n    aspect base {\n        draw circle(1) color:#blue;\n    }\n}\n\nexperiment expe type:gui {\n    output {\n        display my_display {\n            species my_species aspect:base;\n        }\n    }\n}\n")),(0,r.kt)("p",null,"During the execution, you have 2 ways to access to the action:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"When the agent is inspected, they appear as buttons above the agents' attributes")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"images/user_command_inside_species1.png",src:t(76908).Z,width:"1145",height:"698"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'When the agent is selected by a right-click in a display, these commands appear under the usual "Inspect", "Focus" and "Highlight" commands in the pop-up menu.')),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"images/user_command_inside_species2.png",src:t(42078).Z,width:"1148",height:"702"})),(0,r.kt)("p",null,"Remark: The execution of a command obeys the following rules:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"when the command is called from right-click pop-menu, it is executed immediately"),(0,r.kt)("li",{parentName:"ul"},"when the command is called from panels, its execution is postponed until the end of the current step and then executed at that time.")),(0,r.kt)("h3",{id:"user_location"},"user_location"),(0,r.kt)("p",null,"In the special case when the ",(0,r.kt)("inlineCode",{parentName:"p"},"user_command")," is called from the pop-up menu (from a right-click on an agent in a display), the location chosen by the user (translated into the model coordinates) is passed to the execution scope under the name ",(0,r.kt)("inlineCode",{parentName:"p"},"user_location"),"."),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'global {\n   user_command "Create agents here" {\n      create my_species number: 10 with: [location::user_location];\n   }\n}\n')),(0,r.kt)("p",null,'This will allow the user to click on a display, choose the world (always present now), and select the menu item "Create agents here".'),(0,r.kt)("p",null,"Note that if the world is inspected (this ",(0,r.kt)("inlineCode",{parentName:"p"},"user_command")," appears thus as a button) and the user chooses to push the button, the agent will be created at a random location."),(0,r.kt)("h3",{id:"user_input"},"user_input"),(0,r.kt)("p",null,"As it is also, sometimes, necessary to ask the user for some values (not defined as parameters), the ",(0,r.kt)("inlineCode",{parentName:"p"},"user_input")," unary operator has been introduced. This operator takes a map ","[string::value]"," as argument (the key is the name of the chosen parameter, the value is the default value), displays a dialog asking the user for these values, and returns the same map with the modified values (if any). You can also add a text as first argument of the operator, which will be displayed as a title for your dialog popup. The dialog is modal and will interrupt the execution of the simulation until the user has either dismissed or accepted it. It can be used, for instance, in an init section like the following one to force the user to input new values instead of relying on the initial values of parameters."),(0,r.kt)("p",null,"Here is an example of implementation:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'model quick_user_command_model\n\nglobal {\n   init {\n      map values <- user_input("Choose a number of agent to create",["Number" :: 100]);\n      create my_species number: int(values at "Number");\n   }\n}\n\nspecies my_species {\n    aspect base {\n        draw circle(1) color:#blue;\n    }\n}\n\nexperiment expe type:gui {\n    output {\n        display my_display {\n            species my_species aspect:base;\n        }\n    }\n}\n')),(0,r.kt)("p",null,"When running this model, you will first have to input a number:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"images/input_cmd.png",src:t(398).Z,width:"1151",height:"704"})),(0,r.kt)("h2",{id:"user-control-architecture"},"User Control Architecture"),(0,r.kt)("p",null,"The other way to define user interaction is to use user control architecture. Please jump directly to the section ",(0,r.kt)("a",{parentName:"p",href:"ControlArchitecture#user-control-architecture"},"user control architecture")," if you want to learn more about this point."))}h.isMDXComponent=!0},398:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/input_cmd-a6fd423782513253b4ff646c80020bbf.png"},982:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/user_command_inside_expe-ad82594fa55d4cf9ce00c823da9e98d9.png"},76908:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/user_command_inside_species1-e138f59d20c91ff9dc0bc9669bb86b91.png"},42078:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/user_command_inside_species2-d7de7d8576fabcf253dfa0ebe4e86c47.png"}}]);