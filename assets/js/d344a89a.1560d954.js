"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[55100],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),u=i,f=c["".concat(s,".").concat(u)]||c[u]||m[u]||o;return n?a.createElement(f,r(r({ref:t},d),{},{components:n})):a.createElement(f,r({ref:t},d))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:i,r[1]=l;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9514:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>p,toc:()=>c});var a=n(87462),i=n(63366),o=(n(67294),n(3905)),r=["components"],l={title:"3. Integration of GIS Data"},s=void 0,p={unversionedId:"IncrementalModel_step3",id:"IncrementalModel_step3",title:"3. Integration of GIS Data",description:"This step illustrates how to load and agentry GIS data.",source:"@site/../docs/IncrementalModel_step3.md",sourceDirName:".",slug:"/IncrementalModel_step3",permalink:"/wiki/next/IncrementalModel_step3",draft:!1,editUrl:"https://github.com/gama-platform/gama/wiki/IncrementalModel_step3/_edit",tags:[],version:"current",frontMatter:{title:"3. Integration of GIS Data"},sidebar:"tuto",previous:{title:"2. Charts",permalink:"/wiki/next/IncrementalModel_step2"},next:{title:"4. Movement on Graph",permalink:"/wiki/next/IncrementalModel_step4"}},d={},c=[{value:"Formulation",id:"formulation",level:2},{value:"Model Definition",id:"model-definition",level:2},{value:"species",id:"species",level:3},{value:"Global variables",id:"global-variables",level:3},{value:"agentification of GIS data",id:"agentification-of-gis-data",level:3},{value:"environment",id:"environment",level:3},{value:"display",id:"display",level:3},{value:"Complete Model",id:"complete-model",level:2}],m={toc:c};function u(e){var t=e.components,l=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This step illustrates how to load and agentry GIS data."),(0,o.kt)("h2",{id:"formulation"},"Formulation"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Load, agentify and display two layers of GIS data (building and road)."),(0,o.kt)("li",{parentName:"ul"},"Modify the initialization of the people agents to put them inside buildings.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Incremental model 3: integration of shapefile data inside the model.",src:n(79239).Z,width:"3584",height:"2118"})),(0,o.kt)("h2",{id:"model-definition"},"Model Definition"),(0,o.kt)("h3",{id:"species"},"species"),(0,o.kt)("p",null,"To integrate easily the two data layers, we have to define two species of agents: the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"building"))," agents and the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"road"))," ones. These agents will not have a particular behavior, they will just be displayed.\nWe define an aspect for these species. In this model, we want to represent the geometry of the agent, we then use their geometry in the  ",(0,o.kt)("inlineCode",{parentName:"p"},"draw")," statement. In order to draw the geometry of the agent, we use the attribute ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"shape"))," (which is a built-in attribute of all agents)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"species building {\n    aspect default {\n    draw shape color: #gray border: #black;\n    }\n}\n\nspecies road {\n    aspect default {\n    draw shape color: #black;\n    }\n}\n")),(0,o.kt)("h3",{id:"global-variables"},"Global variables"),(0,o.kt)("p",null,"GAMA allows to automatically read GIS data that are formatted as shapefiles. In order to let the user chooses his/her shapefiles, we define two global variables. One allowing the user to choose the road shapefile, one allowing him/her to choose the building shapefile."),(0,o.kt)("p",null,"Definition of the two global variables of type ",(0,o.kt)("inlineCode",{parentName:"p"},"file")," representing the GIS files:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'global {\n    file buildings_shapefile <- file("../includes/building.shp");\n    file roads_shapefile <- file("../includes/road.shp");\n}\n')),(0,o.kt)("h3",{id:"agentification-of-gis-data"},"agentification of GIS data"),(0,o.kt)("p",null,"In GAMA, the agentification of GIS data is very straightforward: it only requires to use the ",(0,o.kt)("inlineCode",{parentName:"p"},"create")," command with the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"from"))," facet with the shapefile. Each object of the shapefile will be directly used to instantiate one agent of the specified species."),(0,o.kt)("p",null,"We modify the init section of the global block in order to create ",(0,o.kt)("inlineCode",{parentName:"p"},"road")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"building")," agents from the shapefiles. Then, we define the initial location of people as a point inside one of the buildings."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"global {\n    ...\n    init {\n    create road from: roads_shapefile;\n    create building from: buildings_shapefile;\n    create people number:nb_people {\n        speed <- agent_speed;\n        location <- any_location_in(one_of(building));\n    }\n    ask nb_infected_init among people {\n        is_infected <- true;\n    }\n    }\n} \n")),(0,o.kt)("p",null,"Note that the name of a species can be used to obtain all the agents of a species (here ",(0,o.kt)("inlineCode",{parentName:"p"},"building")," returns the list of all the buildings). We can thus use the ",(0,o.kt)("inlineCode",{parentName:"p"},"one_of")," operator on ",(0,o.kt)("inlineCode",{parentName:"p"},"building")," to pick a random building agent. The ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"any_location_in"))," operator returns a random point inside a geometry or an agent geometry."),(0,o.kt)("h3",{id:"environment"},"environment"),(0,o.kt)("p",null,"Building a GIS environment in GAMA requires nothing special, just to define the bounds of the environment, i.e. the geometry of the ",(0,o.kt)("inlineCode",{parentName:"p"},"world")," agent. It is possible to use a shapefile to automatically define it by computing its envelope. In this model, we use the road shapefile to define it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"global {\n    ...\n    geometry shape <- envelope(roads_shapefile); \n    ...\n}\n")),(0,o.kt)("h3",{id:"display"},"display"),(0,o.kt)("p",null,"We add to the ",(0,o.kt)("strong",{parentName:"p"},"map")," display the road and building agents. Again, as we named the aspects ",(0,o.kt)("inlineCode",{parentName:"p"},"default")," we can omit to specify them in the ",(0,o.kt)("inlineCode",{parentName:"p"},"species")," inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"display"),"."),(0,o.kt)("p",null,"In the ",(0,o.kt)("inlineCode",{parentName:"p"},"experiment")," block:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"output {\n    display map {\n        species road;\n    species building;\n    species people;         \n    }\n    ...\n}\n")),(0,o.kt)("h2",{id:"complete-model"},"Complete Model"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-gaml",metastring:"reference",reference:!0},"https://github.com/gama-platform/gama/blob/GAMA_1.9.0/msi.gama.models/models/Tutorials/Incremental%20Model/models/Incremental%20Model%203.gaml\n")))}u.isMDXComponent=!0},79239:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Incremental_model3-6c5f4755f5ad6446ca859411b4eed8ff.png"}}]);