"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[14786],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(n),h=r,c=u["".concat(p,".").concat(h)]||u[h]||d[h]||i;return n?a.createElement(c,o(o({ref:t},m),{},{components:n})):a.createElement(c,o({ref:t},m))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},63439:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var a=n(87462),r=n(63366),i=(n(67294),n(3905)),o=["components"],l={title:"13. Model exploration"},p=void 0,s={unversionedId:"PredatorPrey_step13",id:"version-1.8.2-RC1/PredatorPrey_step13",title:"13. Model exploration",description:"This 13th step illustrates how to explore the model using a batch experiment.",source:"@site/versioned_docs/version-1.8.2-RC1/PredatorPrey_step13.md",sourceDirName:".",slug:"/PredatorPrey_step13",permalink:"/wiki/1.8.2-RC1/PredatorPrey_step13",draft:!1,editUrl:"https://github.com/gama-platform/gama/wiki/PredatorPrey_step13/_edit",tags:[],version:"1.8.2-RC1",frontMatter:{title:"13. Model exploration"},sidebar:"tuto",previous:{title:"12. Image loading",permalink:"/wiki/1.8.2-RC1/PredatorPrey_step12"},next:{title:"Road Traffic",permalink:"/wiki/1.8.2-RC1/RoadTrafficModel"}},m={},d=[{value:"Formulation",id:"formulation",level:2},{value:"Model Definition",id:"model-definition",level:2},{value:"batch experiment",id:"batch-experiment",level:3},{value:"Parameters definition",id:"parameters-definition",level:3},{value:"Exploration method",id:"exploration-method",level:3},{value:"Save exploration results",id:"save-exploration-results",level:3},{value:"Deal with the simulation stop",id:"deal-with-the-simulation-stop",level:3},{value:"Conclusion",id:"conclusion",level:2},{value:"Complete Model",id:"complete-model",level:2}],u={toc:d};function h(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This 13th step illustrates how to explore the model using a batch experiment."),(0,i.kt)("h2",{id:"formulation"},"Formulation"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Addition of a new experiment of type batch."),(0,i.kt)("li",{parentName:"ul"},"Definition of the parameters to be explored."),(0,i.kt)("li",{parentName:"ul"},"Definition of the exploration method.")),(0,i.kt)("h2",{id:"model-definition"},"Model Definition"),(0,i.kt)("p",null,"The model itself (the ",(0,i.kt)("inlineCode",{parentName:"p"},"global")," and the various species) will be modified. We will simply add a new experiment to define a new way of launching the simulation."),(0,i.kt)("h3",{id:"batch-experiment"},"batch experiment"),(0,i.kt)("p",null,"We will thus add a new ",(0,i.kt)("inlineCode",{parentName:"p"},"experiment")," in the file. The specificity of this experiment will be its ",(0,i.kt)("inlineCode",{parentName:"p"},"type"),": we will define a ",(0,i.kt)("inlineCode",{parentName:"p"},"batch")," experiment, instead of a ",(0,i.kt)("inlineCode",{parentName:"p"},"gui")," (as done until now). This experiment will not manage any display but will run several simulations to explore the parameter space (depending on the exploration method)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"experiment Optimization type: batch repeat: 2 keep_seed: true until: ( time > 200 ) {\n    ...\n}\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"batch")," experiment comes with more facets:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"repeat")),": the number of simulations to launch for a single parameter configuration,"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"keep_seed")),": set whether the seed of the random number generator is the same for each first replication (the first simulation run for a given parameter configuration),"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"until")),": define the simulation stop condition.")),(0,i.kt)("h3",{id:"parameters-definition"},"Parameters definition"),(0,i.kt)("p",null,"We now need to define the parameters to explore: similarly to ",(0,i.kt)("inlineCode",{parentName:"p"},"gui")," experiment, parameters are taken among the global variables. In a ",(0,i.kt)("inlineCode",{parentName:"p"},"batch")," experiment, it is necessary to define their value range (using the ",(0,i.kt)("inlineCode",{parentName:"p"},"among")," facet or the ",(0,i.kt)("inlineCode",{parentName:"p"},"min"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"max"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"step")," ones)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'parameter "Prey max transfer:" var: prey_max_transfer min: 0.05 max: 0.5 step: 0.05 ;\nparameter "Prey energy reproduce:" var: prey_energy_reproduce min: 0.05 max: 0.75 step: 0.05;\nparameter "Predator energy transfer:" var: predator_energy_transfer min: 0.1 max: 1.0 step: 0.1 ;\nparameter "Predator energy reproduce:" var: predator_energy_reproduce min: 0.1 max: 1.0 step: 0.1;\n')),(0,i.kt)("h3",{id:"exploration-method"},"Exploration method"),(0,i.kt)("p",null,"Finally, the exploration method has to be specified (the default method is exhaustive exploration). GAMA provides several methods, ",(0,i.kt)("a",{parentName:"p",href:"ExplorationMethods"},"detailed in this page"),".\nWe choose here the Tabu search method, defined by:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"method tabu maximize: nb_preys + nb_predators iter_max: 10 tabu_list_size: 3;\n")),(0,i.kt)("h3",{id:"save-exploration-results"},"Save exploration results"),(0,i.kt)("p",null,"In a previous step, we introduced the save of results at each step of a simulation. When exploring a model, it could be interesting to save results after each simulation."),(0,i.kt)("p",null,"To this purpose, we will use again the ",(0,i.kt)("inlineCode",{parentName:"p"},"save")," statement but in a ",(0,i.kt)("inlineCode",{parentName:"p"},"reflex")," of the ",(0,i.kt)("inlineCode",{parentName:"p"},"experiment")," and not a reflex of the model. In ",(0,i.kt)("strong",{parentName:"p"},"a batch experiment"),", the reflexes are executed after all the replications for a single parameter configuration. The built-in ",(0,i.kt)("inlineCode",{parentName:"p"},"simulations")," variable contains all the simulations; we can thus ask them the results we want to save. In addition, we save the parameter values to keep track. "),(0,i.kt)("p",null,"We will use the ",(0,i.kt)("inlineCode",{parentName:"p"},"save")," statement to save the results as a ",(0,i.kt)("inlineCode",{parentName:"p"},"csv")," file (as it is easier to manipulate by analysis software, such as R). We can thus save a list of values:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'reflex save_results_explo {\n    ask simulations {\n    save [int(self),prey_max_transfer,prey_energy_reproduce,predator_energy_transfer,predator_energy_reproduce,self.nb_predators,self.nb_preys] \n          to: "results.csv" type: "csv" rewrite: (int(self) = 0) ? true : false header: true;\n    }       \n}\n')),(0,i.kt)("p",null,"This saved for each simulation its ",(0,i.kt)("inlineCode",{parentName:"p"},"self.nb_predators")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"self.nb_preys"),". Note that ",(0,i.kt)("inlineCode",{parentName:"p"},"self")," here is mandatory!"),(0,i.kt)("h3",{id:"deal-with-the-simulation-stop"},"Deal with the simulation stop"),(0,i.kt)("p",null,"An issue we will have with the model is that it already has a stop condition: it pauses when either the number of preys or the number of predators become zero. We will introduce a new global variable ",(0,i.kt)("inlineCode",{parentName:"p"},"is_batch")," to specify whether the simulation is in batch mode or not. In batch mode, the reflex ",(0,i.kt)("inlineCode",{parentName:"p"},"stop_simulation")," should not be executed."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"global {\n    ...\n    bool is_batch <- false;\n    ...\n    reflex stop_simulation when: ((nb_preys = 0) or (nb_predators = 0)) and !is_batch {\n    do pause ;\n    } \n}\n")),(0,i.kt)("p",null,"This variable should thus now be initialized by default to ",(0,i.kt)("inlineCode",{parentName:"p"},"false")," (so in the ",(0,i.kt)("inlineCode",{parentName:"p"},"init")," block of the model) and in the batch experiment to true."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'experiment Optimization type: batch repeat: 2 keep_seed: true until: ( time > 200 ) {\n    ...\n    parameter "Batch mode:" var: is_batch <- true;\n    ...\n}\n')),(0,i.kt)("h2",{id:"conclusion"},"Conclusion"),(0,i.kt)("p",null,"Congratulations, you have completed your first GAMA models! Now, you have enough knowledge to create many models that includes: dynamic grid-based environment, moving and interacting agents and the needed visualization to make good use of your simulation. Feel free to use this knowledge to create your very own models! Or perhaps you want to continue your study with the more advanced ",(0,i.kt)("a",{parentName:"p",href:"Tutorials"},"tutorials"),"?"),(0,i.kt)("h2",{id:"complete-model"},"Complete Model"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"https://github.com/gama-platform/gama/blob/GAMA_1.8.2/msi.gama.models/models/Tutorials/Predator%20Prey/models/Model%2013.gaml\n")))}h.isMDXComponent=!0}}]);