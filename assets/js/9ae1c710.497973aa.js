"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[51838],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),f=i,m=c["".concat(s,".").concat(f)]||c[f]||u[f]||o;return n?a.createElement(m,r(r({ref:t},d),{},{components:n})):a.createElement(m,r({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:i,r[1]=l;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},57130:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>f,frontMatter:()=>l,metadata:()=>p,toc:()=>c});var a=n(87462),i=n(63366),o=(n(67294),n(3905)),r=["components"],l={title:"5. Definition of 3D displays"},s=void 0,p={unversionedId:"LuneraysFlu_step5",id:"version-1.8.2-RC1/LuneraysFlu_step5",title:"5. Definition of 3D displays",description:"This fifth step illustrates how to define 3D displays.",source:"@site/versioned_docs/version-1.8.2-RC1/LuneraysFlu_step5.md",sourceDirName:".",slug:"/LuneraysFlu_step5",permalink:"/wiki/1.8.2-RC1/LuneraysFlu_step5",draft:!1,editUrl:"https://github.com/gama-platform/gama/wiki/LuneraysFlu_step5/_edit",tags:[],version:"1.8.2-RC1",frontMatter:{title:"5. Definition of 3D displays"},sidebar:"tuto",previous:{title:"4. Use of a graph to constraint the movements of people",permalink:"/wiki/1.8.2-RC1/LuneraysFlu_step4"},next:{title:"6. Exploration of the model",permalink:"/wiki/1.8.2-RC1/LuneraysFlu_step6"}},d={},c=[{value:"Formulation",id:"formulation",level:2},{value:"Model Definition",id:"model-definition",level:2},{value:"species",id:"species",level:3},{value:"output",id:"output",level:3},{value:"Complete Model",id:"complete-model",level:2}],u={toc:c};function f(e){var t=e.components,l=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,a.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This fifth step illustrates how to define 3D displays."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Result of the Luneray Flu model 5.",src:n(6480).Z,width:"3584",height:"2118"})),(0,o.kt)("h2",{id:"formulation"},"Formulation"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Define a new 3D aspect for roads."),(0,o.kt)("li",{parentName:"ul"},"Define a new 3D aspect for buildings"),(0,o.kt)("li",{parentName:"ul"},"Define a new 3D aspect for people"),(0,o.kt)("li",{parentName:"ul"},"Define a new 3D display ")),(0,o.kt)("h2",{id:"model-definition"},"Model Definition"),(0,o.kt)("h3",{id:"species"},"species"),(0,o.kt)("p",null,"We define a new aspect for the road species called ",(0,o.kt)("inlineCode",{parentName:"p"},"geom3D")," that draw the road agent that as a black tube of 2m radius built from its geometry. Note that it is possible to get the list of points composing a geometry by using the ",(0,o.kt)("inlineCode",{parentName:"p"},"points")," variable of the geometry. "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Road image for Luneray&#39;s Flu model.",src:n(52513).Z,width:"75",height:"162"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"species road {\n    //....\n    aspect geom3D {\n    draw line(shape.points, 2.0) color: #black;\n    }\n}\n")),(0,o.kt)("p",null,"Concerning the building species, we define an aspect called ",(0,o.kt)("inlineCode",{parentName:"p"},"geom3D"),' that draws the shape of the building with a depth of 20 meters and with using a texture "texture.jpg" for the face and a texture for the roof "roof',"_",'top.jpg".'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Building image for Luneray&#39;s Flu model.",src:n(27720).Z,width:"82",height:"134"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'species building {\n    //....\n    aspect geom3D {\n    draw shape depth: 20 #m border: #black texture: ["../includes/roof_top.jpg","../includes/texture.jpg"];\n    }\n}\n')),(0,o.kt)("p",null,"At last, we define a new aspect called ",(0,o.kt)("inlineCode",{parentName:"p"},"geom3D")," for the people species that displays the agent only if it is on a road (target != nil). In this aspect, we use an obj file that contains a 3D object. The use of the ",(0,o.kt)("inlineCode",{parentName:"p"},"obj_file")," operator allows to apply an initial rotation to an obj file. In our case, we add a rotation of -90\xb0 along the x-axis. We specify with the ",(0,o.kt)("inlineCode",{parentName:"p"},"size")," facet that we want to draw the 3D object inside a bounding box of 5m. As the location of the 3D object is its centroid and as we want to draw the 3D object on the top of the ground, we use the ",(0,o.kt)("inlineCode",{parentName:"p"},"at")," facet to put an offset along the z-axis. We use also the rotate facet to change the orientation of the 3D object according to the heading of the agent. At last, we choose to draw the 3D object in green if the agent is not infected; in red otherwise."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"3D object used to display people agents in Luneray&#39;s Flu model.",src:n(64244).Z,width:"158",height:"228"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'species people skills:[moving]{     \n    //....\n    aspect geom3D {\n    if target != nil {\n        draw obj_file("../includes/people.obj", 90::{-1,0,0}) size: 5\n        at: location + {0,0,7} rotate: heading - 90 color: is_infected ? #red : #green;\n    }\n    }\n}\n')),(0,o.kt)("h3",{id:"output"},"output"),(0,o.kt)("p",null,"We define a new display called ",(0,o.kt)("inlineCode",{parentName:"p"},"view3D")," of type ",(0,o.kt)("inlineCode",{parentName:"p"},"opengl")," with the facet ",(0,o.kt)("inlineCode",{parentName:"p"},"antialias")," set to false. Inside this display, we first set a ",(0,o.kt)("inlineCode",{parentName:"p"},"light")," of type ",(0,o.kt)("inlineCode",{parentName:"p"},"ambient")," and with an intensity of 80. We then draw a background image representing the satellite image of the Luneray. Note that GAMA is able to manage world files to georeferenced images. In our case, as a PGW file exists in the includes folder, the satellite image will be well localized in the display. After drawing the background image, we display first the building species with their geom3D aspect, then the road species with their geom3D aspect and finally the people species with their geom3D aspect. Only the people agents will be redrawn at each simulation step."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'experiment main_experiment type: gui {\n    output {\n    // monitor and other displays   \n    display view3D type: opengl antialias: false {\n        light #ambient intensity: 80;\n        image "../includes/luneray.jpg" refresh: false; \n        species building aspect: geom3D refresh: false;\n        species road aspect: geom3D refresh: false;\n        species people aspect: geom3D; \n    }\n    }\n}\n')),(0,o.kt)("h2",{id:"complete-model"},"Complete Model"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-gaml",metastring:"reference",reference:!0},"https://github.com/gama-platform/gama/blob/GAMA_1.8.2/msi.gama.models/models/Tutorials/Luneray%20flu/models/model5.gaml\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"LuneraysFlu_step6"},"Next step: Exploration of the model")))}f.isMDXComponent=!0},27720:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/buildings_display-c4d9f59d3fba746e4604472d358e5544.png"},6480:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/luneray5-f7893ccf61f47200a58c911e599bd5e7.png"},64244:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/people_display-d08af31936b4e6ffbbf85f1384a82f34.png"},52513:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAACiCAAAAAAsbm98AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfkAg4EFQIFrPiDAAAA7UlEQVRo3u2aMQ7CMAwAncCKxGsQquBbfUQ3vlRVkRgQP2FhpmUoA1PkwSghvi5drFMcn2wPCYuYfVFgOWKpzNmuv1OXibmOcjxnKWn6YnV9JvIyyqHPsgZ1jlGZo5I1w9KzQqV3H2zvC78acAK/cAK/cAJWvX7hBP0eJ3CC+cgcKjyHPPj1crADNJ+jFqZlzVasjSHLQ47R9r4sz7W0fq5YaR0jfhXrEzhR1C+cgPUXOwBzqA0nPMxHnGD/8ugXOwB+4QR+4YQPltjWESfqZn3enKYhF3QXuWUD0toCNMV+PuJur2gnvNuG9UPWG+a8oLp/DQ7qAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAyLTE0VDA0OjA4OjQwKzAwOjAwfJvDXwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMi0xNFQwNDowODo0MCswMDowMA3Ge+MAAAAASUVORK5CYII="}}]);