<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-2025-06 docs-doc-page docs-doc-id-OptimizingModels" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Optimizing Models | GAMA Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://gama-platform.org/resources/images/general/GamaPlatform.png"><meta data-rh="true" name="twitter:image" content="https://gama-platform.org/resources/images/general/GamaPlatform.png"><meta data-rh="true" property="og:url" content="https://gama-platform.org/wiki/OptimizingModels"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2025-06"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2025-06"><meta data-rh="true" name="docsearch:version" content="2025-06"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2025-06"><meta data-rh="true" property="og:title" content="Optimizing Models | GAMA Platform"><meta data-rh="true" name="description" content="This page aims at presenting some tips to optimize the memory footprint or the execution time of a model in GAMA."><meta data-rh="true" property="og:description" content="This page aims at presenting some tips to optimize the memory footprint or the execution time of a model in GAMA."><link data-rh="true" rel="icon" href="/img/gama-logo.png"><link data-rh="true" rel="canonical" href="https://gama-platform.org/wiki/OptimizingModels"><link data-rh="true" rel="alternate" href="https://gama-platform.org/wiki/OptimizingModels" hreflang="en"><link data-rh="true" rel="alternate" href="https://gama-platform.org/wiki/OptimizingModels" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://MWUOLTL2EG-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Learn GAML step by step","item":"https://gama-platform.org/wiki/LearnGAMLStepByStep"},{"@type":"ListItem","position":2,"name":"Optimizing Models","item":"https://gama-platform.org/wiki/OptimizingModelsSection"},{"@type":"ListItem","position":3,"name":"Optimizing Models","item":"https://gama-platform.org/wiki/OptimizingModels"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="GAMA Platform" href="/opensearch.xml">
<link rel="preconnect" href="https://gama-platform.goatcounter.com">
<script async src="//gc.zgo.at/count.js" data-goatcounter="https://gama-platform.goatcounter.com/count"></script>


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.1/css/all.css"><link rel="stylesheet" href="/assets/css/styles.bb93ecf1.css">
<script src="/assets/js/runtime~main.1ef86994.js" defer="defer"></script>
<script src="/assets/js/main.9fc86d05.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#34709f;color:#e3e3e3" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">ðŸŽ‰ <strong>GAMA Platform 2025-06 is out!!</strong> ðŸŽ‰ <a href="/download"><u>Download it now</u></a> and check <a href="/wiki/Changelog"><u>the changelog</u></a>!! ðŸŽ‰</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/gama-logo.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/gama-logo.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GAMA Platform</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/wiki/Home">Documentation</a><a class="navbar__item navbar__link" href="/wiki/Tutorials">Tutorials</a><a class="navbar__item navbar__link" href="/wiki/Community">Community</a><a class="navbar__item navbar__link" href="/download">Download</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/gama-platform/gama" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="fab fa-github" style="font-size: 24px;"></i></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div id="sidebarCssSelector"><div class="custom-sidebarVersion"><p><u style="padding-top:4px;display:inline-block"><b>Version:</b></u> </p><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/wiki/OptimizingModels">2025-06</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/wiki/next/OptimizingModels">ðŸš§ Alpha ðŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/wiki/OptimizingModels">2025-06</a></li><li><a class="dropdown__link" href="/wiki/1.9.3/OptimizingModels">1.9.3</a></li><li><a class="dropdown__link" href="/wiki/1.9.2/OptimizingModels">1.9.2</a></li><li><a class="dropdown__link" href="/wiki/1.9.1/OptimizingModels">1.9.1</a></li><li><a class="dropdown__link" href="/wiki/1.8.2-RC2/OptimizingModels">1.8.2-RC2</a></li><li><a class="dropdown__link" href="/wiki/1.8.1/OptimizingModels">1.8.1</a></li></ul></div><p></p></div><hr style="margin:0"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/wiki/Home">Home</a><button aria-label="Expand sidebar category &#x27;Home&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/wiki/PlatformDocumentation">Platform</a><button aria-label="Expand sidebar category &#x27;Platform&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/wiki/LearnGAMLStepByStep">Learn GAML step by step</a><button aria-label="Collapse sidebar category &#x27;Learn GAML step by step&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/wiki/Introduction">Introduction</a><button aria-label="Expand sidebar category &#x27;Introduction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/ManipulateBasicSpecies">Manipulate basic species</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/wiki/GlobalSpecies">Global Species</a><button aria-label="Expand sidebar category &#x27;Global Species&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/wiki/DefiningAdvancedSpecies">Defining Advanced Species</a><button aria-label="Expand sidebar category &#x27;Defining Advanced Species&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/wiki/DefiningGUIExperiment">Defining GUI Experiment</a><button aria-label="Expand sidebar category &#x27;Defining GUI Experiment&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/wiki/ExploringModels">Exploring Models</a><button aria-label="Expand sidebar category &#x27;Exploring Models&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/wiki/OptimizingModelsSection">Optimizing Models</a><button aria-label="Collapse sidebar category &#x27;Optimizing Models&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/RuntimeConcepts">Runtime Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/AnalysingCodePerformance">Analysing code performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/wiki/OptimizingModels">Optimizing Models</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/wiki/MultiParadigmModeling">Multi-Paradigm Modeling</a><button aria-label="Expand sidebar category &#x27;Multi-Paradigm Modeling&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/wiki/Recipes">Recipes</a><button aria-label="Expand sidebar category &#x27;Recipes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/wiki/GamlReference">GAML References</a><button aria-label="Expand sidebar category &#x27;GAML References&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/wiki/developingGAMA">Developing GAMA</a><button aria-label="Expand sidebar category &#x27;Developing GAMA&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/wiki/LearnGAMLStepByStep"><span>Learn GAML step by step</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/wiki/OptimizingModelsSection"><span>Optimizing Models</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Optimizing Models</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2025-06</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Optimizing Models</h1></header><p>This page aims at presenting some tips to optimize the memory footprint or the execution time of a model in GAMA.</p>
<blockquote>
<p>[!Note]
The optimizations presented here are only general ideas that work most of the time, but every model is different and sometimes those optimizations won&#x27;t work or even produce worse execution time. It is thus highly recommended that you try them yourself on your setup and that you build test environment with the tools explained in the previous page (<a href="/wiki/AnalysingCodePerformance">analysing code performance</a>) to make sure that they are useful <strong>to your model</strong>._</p>
</blockquote>
<blockquote>
<p>[!Note]
Some previously known optimizations from GAMA 1.6.1 and above, have become obsolete because they have been included in the compiler. They have, then, been removed from this page. For instance, writing <code>rgb(0,0,0)</code> is now compiled directly as <code>#black</code>._</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scheduling">Scheduling<a href="#scheduling" class="hash-link" aria-label="Direct link to Scheduling" title="Direct link to Scheduling">â€‹</a></h2>
<p>If you have a species of agents that, once created, are not supposed to do anything more (i.e. no behavior, no reflex, their actions triggered by other agents, their attributes being simply read and written by other agents), such as a &quot;data&quot; grid, or agents representing a &quot;background&quot; (from a shape file, etc.), consider using the <code>schedules: []</code> facet on the definition of their species. This trick allows to tell GAMA to not schedule any of these agents.</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">height:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">width:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">schedules:</span><span class="token plain"> []  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">      </span><span class="token punctuation">..</span><span class="token punctuation">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>The <code>schedules</code> facet is dynamically computed (even if the agents are not scheduled), so, if you happen to define agents that only need to be scheduled every x cycles, or depending on a condition, you can also write <code>schedules</code> to implement this. For instance, the following species will see its instances scheduled every 10 steps and only if a certain condition is met:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">my_species</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">schedules:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">every</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token plain"> ? </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">condition</span><span class="token plain"> ? </span><span class="token variable" style="color:rgb(28,125,180)">my_species</span><span class="token plain"> </span><span class="token punctuation">:</span><span class="token plain"> []</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">:</span><span class="token plain"> []  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">     </span><span class="token punctuation">..</span><span class="token punctuation">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>In the same way, modelers can use the frequency facet to define when the agents of a species are going to be activated. By setting this facet to 0, the agents are never activated.</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">my_species</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">frequency:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">     </span><span class="token punctuation">..</span><span class="token punctuation">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performances">Performances<a href="#performances" class="hash-link" aria-label="Direct link to Performances" title="Direct link to Performances">â€‹</a></h4>
<p>Consider the following model:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">global</span><span class="token plain"> {	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb_cells</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">1000</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">bool </span><span class="token variable" style="color:rgb(28,125,180)">is_scheduled</span><span class="token plain"> &lt;- </span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">height:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">nb_cells</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">width:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">nb_cells</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">schedules:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">is_scheduled</span><span class="token plain"> ? </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token punctuation">:</span><span class="token plain"> []  </span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<blockquote>
<p>With 1 million grid cells, 1 step lasts in average <strong>0.3 ms without scheduling my_grid agents vs 250 ms with scheduling</strong> (GAMA 2025-05).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="grid">Grid<a href="#grid" class="hash-link" aria-label="Direct link to Grid" title="Direct link to Grid">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimization-facets">Optimization Facets<a href="#optimization-facets" class="hash-link" aria-label="Direct link to Optimization Facets" title="Direct link to Optimization Facets">â€‹</a></h3>
<p>In this section, we present some facets that allow to optimize the use of grids (in particular in terms of memory). Note that all these facets can be combined (see the Life model from the Models library).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="use_regular_agents"><code>use_regular_agents</code><a href="#use_regular_agents" class="hash-link" aria-label="Direct link to use_regular_agents" title="Direct link to use_regular_agents">â€‹</a></h4>
<p>If false, then a special class of agents is used. This special class of agents uses fewer memories but has some limitations: the agents cannot inherit from a &quot;normal&quot; species, they cannot have sub-populations, their name cannot be modified, etc.</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">cell</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">width:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">50</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">height:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">50</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">use_regular_agents:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token plain"> </span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="use_individual_shapes"><code>use_individual_shapes</code><a href="#use_individual_shapes" class="hash-link" aria-label="Direct link to use_individual_shapes" title="Direct link to use_individual_shapes">â€‹</a></h4>
<p>If false, then only one geometry is used for all agents. This facet allows to gain a lot of memory, but should not be used if the geometries of the agents are often activated (for instance, by an aspect).</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">cell</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">width:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">50</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">height:</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">50</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">use_individual_shapes:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token plain"> </span><span class="token punctuation">;</span><span class="token plain">	</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performances-1">Performances<a href="#performances-1" class="hash-link" aria-label="Direct link to Performances" title="Direct link to Performances">â€‹</a></h4>
<p>Consider the following model:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">global</span><span class="token plain"> {	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb_cells</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">2000</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">bool </span><span class="token variable" style="color:rgb(28,125,180)">Puse_individual_shapes</span><span class="token plain"> &lt;- </span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">bool </span><span class="token variable" style="color:rgb(28,125,180)">Puse_regular_agents</span><span class="token plain"> &lt;- </span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">height:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">nb_cells</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">width:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">nb_cells</span><span class="token plain"> 	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token facet" style="color:rgb(154,72,71)">use_individual_shapes:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">Puse_individual_shapes</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token facet" style="color:rgb(154,72,71)">use_regular_agents:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">Puse_regular_agents</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">string </span><span class="token variable" style="color:rgb(28,125,180)">toto</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>With 4 million grid cells, the memory used by the creation of the grid is displayed below, depending on the values of the 2 facets of <code>grid</code> (GAMA 2025-05). On this simple example, <strong>the memory use is then reduced by 35%.</strong></p>
</blockquote>
<table><thead><tr><th>use_individual_shapes</th><th>use_regular_agents</th><th>Memory used (MB)</th></tr></thead><tbody><tr><td>false</td><td>false</td><td>3308.38</td></tr><tr><td>false</td><td>true</td><td>3307.90</td></tr><tr><td>true</td><td>false</td><td>5097.77</td></tr><tr><td>true  (default)</td><td>true   (default)</td><td>5073.43</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parallel-execution">Parallel execution<a href="#parallel-execution" class="hash-link" aria-label="Direct link to Parallel execution" title="Direct link to Parallel execution">â€‹</a></h3>
<p>The <code>grid</code> statement can also specify whether the agents of the grid are computed in parallel, using the facet <code>parallel</code>. This could increase (depending on the computation) the execution time.
For more details about the pros and cons of doing so, please refer to the <a href="#parallel">parallel</a> section.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-of-field-instead-of-grids">Use of <code>field</code> instead of grids<a href="#use-of-field-instead-of-grids" class="hash-link" aria-label="Direct link to use-of-field-instead-of-grids" title="Direct link to use-of-field-instead-of-grids">â€‹</a></h3>
<p><code>grid</code> provides a simple way to manipulate raster data in an agent-based model using agents. It is also perfect to discretize the environment and provides an easy way to locate and move agents in space. Nevertheless, as each cell is an agent, it can be very memory-consuming to use this approach. To round this issue, <code>field</code> data types have been introduced. <strong>A <code>field</code> can be summarized as a spatialized matrix.</strong> It could be considered as a great alternative to grid when the agentification of each cell is not so important, e.g., when the grid represents a landscape where cells contain a biomass value of a crop.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-memory-used">Performance (Memory used)<a href="#performance-memory-used" class="hash-link" aria-label="Direct link to Performance (Memory used)" title="Direct link to Performance (Memory used)">â€‹</a></h4>
<p>To investigate the memory footprint by fields, we compute the memory used by a simulation (in fact, the average over 5 initializations) after the initialisation when creating 1, 5, 10 fields of different sizes. As a comparison, a grid 2000x2000 with 1 attribute (so equivalent to 1 field) uses ~3300MB (versus ~1850MB for 1 field) and a grid 5000x5000 with 1 attribute uses at least 21GBytes, with an initialization time much higher.</p>
<table><thead><tr><th>Number of Agents</th><th>1 Field (MB)</th><th>5 Fields (MB)</th><th>10 Fields (MB)</th></tr></thead><tbody><tr><td>2000 * 2000</td><td>3180.22</td><td>3299.00</td><td>3467.11</td></tr><tr><td>5000 * 5000</td><td>3340.59</td><td>4103.78</td><td>5066.26</td></tr><tr><td>10000 * 10000</td><td>3919.9</td><td>6981.23</td><td>10823.51</td></tr><tr><td>20000 * 20000</td><td>6207.72</td><td>18417.16</td><td>More than 32 GB</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-time">Performance (time)<a href="#performance-time" class="hash-link" aria-label="Direct link to Performance (time)" title="Direct link to Performance (time)">â€‹</a></h4>
<p>A simple test of time performance consists of executing a simple update of an attribute of the grid or an update of the field values. The following table displays the average duration of a step, with and without the parallel facet set to true for the grid. Field is much faster for this simple update.</p>
<table><thead><tr><th>Filed (ms)</th><th>Grid with parallel: false (ms)</th><th>Grid with parallel: true (ms)</th></tr></thead><tbody><tr><td>0.015</td><td>1920</td><td>670</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="operators">Operators<a href="#operators" class="hash-link" aria-label="Direct link to Operators" title="Direct link to Operators">â€‹</a></h2>
<p>In GAMA, as in any other languages, some operators or order of execution of operators are more efficient than others. This section is dedicated to identify common mistakes and provide better alternative in the use of operators.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="list-operators">List operators<a href="#list-operators" class="hash-link" aria-label="Direct link to List operators" title="Direct link to List operators">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="first_with">first_with<a href="#first_with" class="hash-link" aria-label="Direct link to first_with" title="Direct link to first_with">â€‹</a></h4>
<p>It is sometimes necessary to randomly select an element of a list that verifies a given condition.
Many modelers use the <strong><code>one_of</code></strong> and the <strong><code>where</code></strong> operators to do this:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token variable" style="color:rgb(28,125,180)">bug</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">one_big_bug</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">one_of</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">bug</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">where</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">size</span><span class="token plain"> &gt; </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>Whereas it is often more optimized to use the <strong><code>shuffle</code></strong> operator to shuffle the list, then the <strong><code>first_with</code></strong> operator to select the first element that verifies the condition:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token variable" style="color:rgb(28,125,180)">bug</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">one_big_bug</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">shuffle</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">bug</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">first_with</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">size</span><span class="token plain"> &gt; </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="performance">Performance<a href="#performance" class="hash-link" aria-label="Direct link to Performance" title="Direct link to Performance">â€‹</a></h5>
<p>Below are some performance data. The second method (shuffle and first_with) provides much better results, whatever the size of the list of bugs. The results below have been produced with 1M bug agents.</p>
<table><thead><tr><th>Method</th><th>Average Time (ms)</th></tr></thead><tbody><tr><td><code>one_of</code></td><td>450.61</td></tr><tr><td><code>first_with</code></td><td>128.48</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="where--count">where / count<a href="#where--count" class="hash-link" aria-label="Direct link to where / count" title="Direct link to where / count">â€‹</a></h4>
<p>It is quite common to want to count the number of elements of a list or a container that verify a condition.
Several options are possible, including:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">n</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">length</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">my_container</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">where</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">size</span><span class="token plain"> &gt; </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>or using the dedicated <code>count</code> operator:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">n</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">my_container</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">count</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">size</span><span class="token plain"> &gt; </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="performance-1">Performance<a href="#performance-1" class="hash-link" aria-label="Direct link to Performance" title="Direct link to Performance">â€‹</a></h5>
<p>Below are some performance data. We can notice that <strong>both methods have similar results</strong> (showing that <code>length</code> operator execution time is very small). The execution is approximately linear with the number of elements of the list.</p>
<table><thead><tr><th>Number of Elements</th><th>length / where (avg ms)</th><th>count (avg ms)</th></tr></thead><tbody><tr><td>100</td><td>0.0424</td><td>0.0616</td></tr><tr><td>1,000</td><td>0.3556</td><td>0.3268</td></tr><tr><td>10,000</td><td>4.4532</td><td>4.9113</td></tr><tr><td>100,000</td><td>53.6059</td><td>54.8167</td></tr><tr><td>1,000,000</td><td>614.4510</td><td>602.4465</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spatial-operators">Spatial operators<a href="#spatial-operators" class="hash-link" aria-label="Direct link to Spatial operators" title="Direct link to Spatial operators">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="container-of-agents-in-closest_to-at_distance-overlapping-inside">container of agents in <code>closest_to</code>, <code>at_distance</code>, <code>overlapping</code>, <code>inside</code><a href="#container-of-agents-in-closest_to-at_distance-overlapping-inside" class="hash-link" aria-label="Direct link to container-of-agents-in-closest_to-at_distance-overlapping-inside" title="Direct link to container-of-agents-in-closest_to-at_distance-overlapping-inside">â€‹</a></h4>
<p>Several spatial query operators (such as <strong><code>closest_to</code></strong>, <strong><code>at_distance</code></strong>, <strong><code>overlapping</code></strong>, or <strong><code>inside</code></strong>) allow to restrict the agents being queried to a container of agents. For instance, one can write:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">agent </span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">a_container_containing_agents</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>This expression is formally equivalent to :</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">agent </span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">a_container_containing_agent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">with_min_of</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">distance_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>But <code>closest_to</code> is much faster <strong>if the container is large</strong>, as it will query the agents using a spatial index (instead of browsing the whole container). Note that sometimes, when you have a small number of agents, the first syntax will be faster. The same applies to the other operators.</p>
<p>Below are the results of the execution of the 2 examples above (in average of 10 repetitions), with different sizes of the container. The model creates 1,000,001 agents, chooses 1 randomly, and creates sublists of various sizes among all the other agents.</p>
<table><thead><tr><th>Number of Elements</th><th>closest_to (avg ms)</th><th>with_min_of / distance_to (avg ms)</th></tr></thead><tbody><tr><td>100</td><td>89.65</td><td>0.05</td></tr><tr><td>1,000</td><td>79.30</td><td>0.39</td></tr><tr><td>10,000</td><td>2.90</td><td>4.80</td></tr><tr><td>100,000</td><td>18.29</td><td>94.85</td></tr><tr><td>1,000,000</td><td>202.15</td><td>1125.64</td></tr></tbody></table>
<p>In the previous example, we focused on getting the closest agent over a set of agents. But it is common to want to get the closest agent among all the agents of a species. In that case, we can use the species name instead of a container. The species name is, in fact, the population of all the agents of a species. Note that, even if predator and list(predator) are very similar, they are not of the same datatype.</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">closest_predator</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">with_min_of</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">distance_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>or</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">closest_predator</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">list</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>But these two operators can be painfully slow if your species has many instances (even in the second form). In that case, always prefer using <strong>directly</strong> the species directly as the left member:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">closest_</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">predator</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>Not only is the syntax clearer, but the speed gain can be phenomenal because, in that case, the list of instances is not used (we just check if the agent is an instance of the left species).</p>
<p>Below are the results of the execution of the 3 examples above (in average of 10 repetitions), with different sizes of the population. The model creates N agents of a species and 1 agent of another species. <strong>We can see that species closest_to is definitely highly more performant than the 2 other approaches.</strong></p>
<table><thead><tr><th>Number of Elements</th><th>with_min_of / distance_to (avg ms)</th><th>list closest_to (avg ms)</th><th>species closest_to (avg ms)</th></tr></thead><tbody><tr><td>100</td><td>0.016</td><td>0.017</td><td>0.008</td></tr><tr><td>1,000</td><td>0.145</td><td>0.085</td><td>0.006</td></tr><tr><td>10,000</td><td>1.661</td><td>0.834</td><td>0.004</td></tr><tr><td>100,000</td><td>23.738</td><td>12.393</td><td>0.019</td></tr><tr><td>1,000,000</td><td>554.434</td><td>310.786</td><td>0.159</td></tr></tbody></table>
<p>However, what happens if one wants to query instances belonging to 2 or more species? If we follow our reasoning, the immediate way to write it would be (if predator 1 and predator 2 are two species):</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">agent </span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> &lt;- </span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">list</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">predator1</span><span class="token punctuation">)</span><span class="token plain"> + </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">list</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">predator2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><span class="token plain"> </span><br></span></code></pre></div></div>
<p>or, more simply:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">agent </span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> &lt;- </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">predator1</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">predator2</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>The first syntax suffers from the same problem as the previous syntax: GAMA has to browse through the list (created by the concatenation of the species populations) to filter agents. The solution, then, is again to use directly the species, as GAMA is clever enough to create a temporary &quot;fake&quot; population out of the concatenation of several species, which can be used exactly like a list of agents, but provides the advantages of a species population (no iteration made during filtering).</p>
<p>Below are the results of the execution of the 2 examples above (in average of 10 repetitions), with different sizes of the population. The model creates N/2 agents of each of 2 species and 1 agent of another third species. <strong>We can see that species closest_to is definitely highly more performant than the other approache.</strong></p>
<table><thead><tr><th>Number of Elements</th><th>concat list (avg ms)</th><th>concat species (avg ms)</th></tr></thead><tbody><tr><td>100</td><td>0.019</td><td>0.010</td></tr><tr><td>1,000</td><td>0.103</td><td>0.003</td></tr><tr><td>10,000</td><td>1.066</td><td>0.015</td></tr><tr><td>100,000</td><td>10.748</td><td>0.041</td></tr><tr><td>1,000,000</td><td>214.712</td><td>0.252</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="accelerate-closest_to-with-a-first-spatial-filtering">Accelerate <strong><code>closest_to</code></strong> with a first spatial filtering<a href="#accelerate-closest_to-with-a-first-spatial-filtering" class="hash-link" aria-label="Direct link to accelerate-closest_to-with-a-first-spatial-filtering" title="Direct link to accelerate-closest_to-with-a-first-spatial-filtering">â€‹</a></h4>
<p>The <strong><code>closest_to</code></strong> operator can sometimes be slow if numerous agents are concerned by this query. If the modeler is just interested in a small subset of agents, it is possible to apply a first spatial filtering on the agent list by using the <strong><code>at_distance</code></strong> operator.</p>
<p>For example, if the modeler wants first to do a spatial filtering of 10m:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token variable" style="color:rgb(28,125,180)">predator1</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> &lt;- </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">predator1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">at_distance</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><br></span></code></pre></div></div>
<p>To be sure to find an agent, the modeler can use a test statement:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">agent </span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> &lt;- </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">predator1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">at_distance</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain"> = </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">nil</span><span class="token punctuation">)</span><span class="token plain"> {</span><span class="token variable" style="color:rgb(28,125,180)">closest_agent</span><span class="token plain">  &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">predator1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">closest_to</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">self</span><span class="token punctuation">;</span><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Below are the results of the execution of the 2 examples above (in average of 10 repetitions), with different sizes of the population. The model creates N/2 agents of each of 2 species and 1 agent of another third species. <strong>We can see that species closest_to is definitely highly more performant than the other approach.</strong></p>
<table><thead><tr><th>Number of Elements</th><th><code>filter â†’ closest_to</code> (avg ms)</th><th><code>closest_to on species â†’ filter</code> (avg ms)</th></tr></thead><tbody><tr><td>100</td><td>0.01077</td><td>0.00849</td></tr><tr><td>1,000</td><td>0.02844</td><td>0.00227</td></tr><tr><td>10,000</td><td>0.21476</td><td>0.00374</td></tr><tr><td>100,000</td><td>3.698</td><td>0.02328</td></tr><tr><td>1,000,000</td><td>52.077</td><td>0.16445</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="displays">Displays<a href="#displays" class="hash-link" aria-label="Direct link to Displays" title="Direct link to Displays">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="shape">shape<a href="#shape" class="hash-link" aria-label="Direct link to shape" title="Direct link to shape">â€‹</a></h3>
<p>It is quite common to want to display an agent as a circle or a square. A common mistake is to mix up the shape to draw and the geometry of the agent in the model. If the modeler just wants to display a particular shape, he/she should not modify the agent geometry (i.e. its <code>shape</code> attribute, which is a point by default), but just specify the shape to draw in the agent aspect.</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">bug</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">     </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">size</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">rnd</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">      </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">aspect</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">circle</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">          </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">draw</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">circle</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">2</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">color:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#blue</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="circle-vs-square--sphere-vs-cube">circle vs square / sphere vs cube<a href="#circle-vs-square--sphere-vs-cube" class="hash-link" aria-label="Direct link to circle vs square / sphere vs cube" title="Direct link to circle vs square / sphere vs cube">â€‹</a></h3>
<p>Note that in OpenGL (3D) and Java2D (2D), the two rendering subsystems used in GAMA, creating and drawing a circle geometry is more time consuming than creating and drawing a square (or a rectangle). In the same way, drawing a sphere is more time consuming than drawing a cube. Hence, if you want to optimize your model displays and if the rendering does not explicitly need &quot;rounded&quot; agents, try to use squares/cubes rather than circles/spheres.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="opengl-refresh-facets">OpenGL refresh facets<a href="#opengl-refresh-facets" class="hash-link" aria-label="Direct link to OpenGL refresh facets" title="Direct link to OpenGL refresh facets">â€‹</a></h3>
<p>In OpenGL display, it is possible to specify that it is not necessary to refresh a layer with the facet <strong><code>refresh</code></strong>. If in a species, the properties used for visualization (location, shape or color) are never modified, you can set <strong><code>refresh</code></strong> to false. Example:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">display</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">city_display_opengl</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">type:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">opengl</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">     </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">building</span><span class="token plain"> </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">aspect</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">base</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">refresh:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">     </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">road</span><span class="token plain"> </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">aspect</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">base</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">refresh:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">     </span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">people</span><span class="token plain"> </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">aspect</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">base</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manipulating-containers-and-species">Manipulating containers and species<a href="#manipulating-containers-and-species" class="hash-link" aria-label="Direct link to Manipulating containers and species" title="Direct link to Manipulating containers and species">â€‹</a></h2>
<p>Manipulating containers (lists, maps etc.) and agents are usually the core of a model and the most critical parts of the code in terms of performances.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parallel">parallel<a href="#parallel" class="hash-link" aria-label="Direct link to parallel" title="Direct link to parallel">â€‹</a></h3>
<p>It is possible to execute the reflexes of agents of a species in parallel threads. This can greatly improve the execution time of a model as by default agents are executed one after another. To activate parallel execution of agents you just need to set the <code>parallel</code> facet of the <code>species</code> (or <code>grid</code>) to true:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">dummy_species</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">parallel:</span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">parallel:</span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>[!Note]
By default this option is not activated because we <strong>cannot guaranty the reproducibility of an experiment</strong> if it is. It implies that we do not know in advance which agent is going to be executed first, this also means that if your agents are meant to be executed in a certain order, this could break your model.</p>
</blockquote>
<p>Take for example this model where each cell of a grid has an effect on its neighbouring cells ,here disabling them, each disabled cell will be represented by the red color and enabled cells by the green color:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">model</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">parallel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">parallel:</span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">width:</span><span class="token number" style="color:rgb(125,125,125)">5</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">height:</span><span class="token number" style="color:rgb(125,125,125)">5</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">bool </span><span class="token variable" style="color:rgb(28,125,180)">to_be_executed</span><span class="token plain"> &lt;- </span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">rgb </span><span class="token variable" style="color:rgb(28,125,180)">color</span><span class="token plain"> &lt;- </span><span class="token constant" style="color:rgb(0, 0, 0)">#green</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">update:</span><span class="token variable" style="color:rgb(28,125,180)">to_be_executed</span><span class="token plain"> ? </span><span class="token constant" style="color:rgb(0, 0, 0)">#green</span><span class="token plain"> </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(0, 0, 0)">#red</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">cancel_neighbours</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">if</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">to_be_executed</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">write</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;I am cell &#x27;&quot;</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">name</span><span class="token plain"> + </span><span class="token string" style="color:rgb(116,167,251)">&quot;&#x27; and my reflexes are executed&quot;</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">c</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">over:</span><span class="token variable" style="color:rgb(28,125,180)">neighbors</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">				</span><span class="token variable" style="color:rgb(28,125,180)">c</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">to_be_executed</span><span class="token plain"> &lt;- </span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			}			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token variable" style="color:rgb(28,125,180)">to_be_executed</span><span class="token plain"> &lt;- </span><span class="token boolean" style="color:rgb(125,125,125)">true</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(63,127,95)">// we reset for the next cycle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">experiment</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">a</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">output</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">display</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">main</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">type:</span><span class="token plain">2d </span><span class="token facet" style="color:rgb(154,72,71)">antialias:</span><span class="token boolean" style="color:rgb(125,125,125)">false</span><span class="token plain">{			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">grid</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">my_grid</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">border:</span><span class="token constant" style="color:rgb(0, 0, 0)">#black</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>With parallel set to <code>false</code> (the default) the order of execution of each cell is always the same and can be predicted to yield this display after the first cycle:</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/8f968b7c-930f-4f15-a03d-260432417a39" alt="image" class="img_ev3q"></p>
<p>But if you change its value to <code>true</code> you can end up with this:</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/6a8c0f96-c71d-4a0f-bce4-bfef87cb7375" alt="image" class="img_ev3q">
And it can change every cycle (or not) and there&#x27;s no way to know in advance how it&#x27;s going to look.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="iterating-over-containers">Iterating over containers<a href="#iterating-over-containers" class="hash-link" aria-label="Direct link to Iterating over containers" title="Direct link to Iterating over containers">â€‹</a></h3>
<p>In gama there are multiple ways of iterating over containers and agents:</p>
<ul>
<li>the <code>ask</code> statement to iterate over agents</li>
<li>the <code>loop</code> statement to iterate over anything, with its multiple syntaxes:<!-- -->
<ul>
<li><code>times</code> iterates a certain number of times</li>
<li><code>over</code> iterates directly over a list</li>
<li><code>from</code> and <code>to</code> provide an index to iterate in a range of values</li>
<li><code>until</code> iterates until a certain condition is met</li>
</ul>
</li>
<li>the different container operators (such as <code>collect</code> or <code>where</code>) provide shortcuts for generic list manipulation tasks</li>
</ul>
<p>In general the specialized operators (see <a href="/wiki/OperatorsAA#containers-related-operators">this page</a> in the documentation for the full list) are way more efficient, followed by <code>ask</code> and the loop <code>over</code>, then comes the other loop syntaxes.
So as a general rule of thumb you should <strong>use as much as possible the container-related operators</strong> instead of the generic <code>loop</code> and <code>ask</code> statements.
Here is an example model that showcases the difference in execution time of the different methods to sum the value of a property of all the agents in the simulation:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">model</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">accessinglistitems</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">global</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb_agents</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">50000</span><span class="token punctuation">;</span><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">species </span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">init</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">rnd</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">experiment</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">e</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">parameter</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;number of agents&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">var:</span><span class="token variable" style="color:rgb(28,125,180)">nb_agents</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">fill_list_from_agents</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">write</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;Start benchmarking with &quot;</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">nb_agents</span><span class="token plain"> + </span><span class="token string" style="color:rgb(116,167,251)">&quot; agents&quot;</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token comment" style="color:rgb(63,127,95)">// we reset the agents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">ask</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">die</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">create</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">number:</span><span class="token variable" style="color:rgb(28,125,180)">nb_agents</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">s1</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;sum with loop over&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s1</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">obj</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">over:</span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">				</span><span class="token variable" style="color:rgb(28,125,180)">s1</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">s1</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">obj</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">s2</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;sum with loop from to&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">to</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">length</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token punctuation">)</span><span class="token plain">-</span><span class="token number" style="color:rgb(125,125,125)">1</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s2</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">i</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">from:</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">to:</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">to</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">				</span><span class="token variable" style="color:rgb(28,125,180)">s2</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">s2</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain">[</span><span class="token variable" style="color:rgb(28,125,180)">i</span><span class="token plain">]</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">s3</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;sum with loop times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">to</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">length</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">i</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s3</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">times:</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">to</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">				</span><span class="token variable" style="color:rgb(28,125,180)">s3</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">s3</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain">[</span><span class="token variable" style="color:rgb(28,125,180)">i</span><span class="token plain">]</span><span class="token punctuation">.</span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">				</span><span class="token variable" style="color:rgb(28,125,180)">i</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">i</span><span class="token plain"> + </span><span class="token number" style="color:rgb(125,125,125)">1</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">s4</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;sum with ask&quot;</span><span class="token plain">  </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s4</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">ask</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">				</span><span class="token variable" style="color:rgb(28,125,180)">s4</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">s4</span><span class="token plain"> + </span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">s5</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;sum with collect&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s5</span><span class="token plain"> &lt;- </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">sum</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">b</span><span class="token plain"> </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">collect</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(0, 0, 0);font-style:italic">each</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">.</span><span class="token variable" style="color:rgb(28,125,180)">v</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token comment" style="color:rgb(63,127,95)">// we check that all methods yield the same result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">assert</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">s1</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(28,125,180)">s2</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">assert</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">s2</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(28,125,180)">s3</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">assert</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">s3</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(28,125,180)">s4</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">assert</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">s4</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(28,125,180)">s5</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Which gives results similar to this:</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/6baa35bb-0dc6-4957-bcc8-b59827c3545c" alt="image" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="big-string-manipulation">Big string manipulation<a href="#big-string-manipulation" class="hash-link" aria-label="Direct link to Big string manipulation" title="Direct link to Big string manipulation">â€‹</a></h2>
<p>String manipulation, and especially concatenation (adding two strings together) is harmless for performances in normal condition, but once strings become big enough (thousands of characters), every operation becomes extremely costly. Moreover, the execution time of concatenation seem to be an exponential function of the size of the string.
Take for example this model:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">model</span><span class="token plain"> </span><span class="token variableDefinition">stringconcat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">experiment</span><span class="token plain"> </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">test</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concat</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">string </span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb_concat</span><span class="token plain"> &lt;- </span><span class="token number" style="color:rgb(125,125,125)">100</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">times:</span><span class="token variable" style="color:rgb(28,125,180)">nb_concat</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token plain"> + </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">rnd</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>We are simply concatenating random digits into a string, ending up with a 100 character string.
So far so good, this is good enough and works flawlessly on most machines. Now change <code>nb_concat</code> to <code>100000</code> and the operation starts to be non-negligible (for example it takes more than half a second on my computer).
We can modify a bit the model to have a more precise idea of how long it takes, and let&#x27;s check how long it would take to compute 200 000 and 300 000 concatenations:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">model</span><span class="token plain"> </span><span class="token variableDefinition">stringconcat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">experiment</span><span class="token plain"> </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">test</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">action </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb</span><span class="token punctuation">)</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">string </span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token plain"> &lt;- </span><span class="token string" style="color:rgb(116,167,251)">&#x27;&#x27;</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">times:</span><span class="token variable" style="color:rgb(28,125,180)">nb</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token plain"> + </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">rnd</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concat</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;concatenating 100 000 times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token plain">  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;concatenating 200 000 times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token plain">  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">200000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;concatenating 300 000 times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token plain">  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">300000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>With that model you should notice that 200 000  characters is significantly slower than 100 000, in my case it was more than 4 times slower, and 300 000 even more as it was almost 10 times slower. Results on my computer looked like this:</p>
<table><thead><tr><th style="text-align:right">number of concatenations</th><th style="text-align:center">100 000 characters</th><th style="text-align:center">200 000 characters</th><th style="text-align:center">300 000 characters</th></tr></thead><tbody><tr><td style="text-align:right"><strong>duration</strong></td><td style="text-align:center">619 ms</td><td style="text-align:center">2563 ms</td><td style="text-align:center">5749 ms</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/fd31d76a-875b-4bd3-9e36-ce19aa7c3f11" alt="image" class="img_ev3q"></p>
<p>This can be particularly annoying because creating big string is itself a way to optimize outputing data from a model (it is often faster to write a big string once than small strings many times).</p>
<p>To help with string concatenation, it is advised to use the <a href="/wiki/OperatorsBC#concatenate">concatenate</a> operator: instead of concatenating many times your text into one string, append each small string into a list of string, and when all the component are collected, merge them only once with the operator.
Let&#x27;s modify the previous model to see how it works:</p>
<div class="language-gaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#282A36;--prism-background-color:#FFFFFF"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-gaml codeBlock_bY9V thin-scrollbar" style="color:#282A36;background-color:#FFFFFF"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#282A36"><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">model</span><span class="token plain"> </span><span class="token variableDefinition">stringconcat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain"></span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">experiment</span><span class="token plain"> </span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">test</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">action </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">int </span><span class="token variable" style="color:rgb(28,125,180)">nb</span><span class="token punctuation">)</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">list</span><span class="token plain">&lt;</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">string</span><span class="token plain">&gt; </span><span class="token variable" style="color:rgb(28,125,180)">list_strings</span><span class="token plain"> &lt;- []</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">loop</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">times:</span><span class="token variable" style="color:rgb(28,125,180)">nb</span><span class="token plain">{</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token variable" style="color:rgb(28,125,180)">list_strings</span><span class="token plain"> &lt;+ </span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">string</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(46,93,78);font-style:bold">rnd</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token type_statement" style="color:rgb(127,0,85);font-style:bold">string </span><span class="token variable" style="color:rgb(28,125,180)">s</span><span class="token plain"> &lt;- </span><span class="token variable" style="color:rgb(28,125,180)">concatenate</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(28,125,180)">list_strings</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">reflex</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concat</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;concatenating 100 000 times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token plain">  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;concatenating 200 000 times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token plain">  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">200000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">benchmark</span><span class="token plain"> </span><span class="token string" style="color:rgb(116,167,251)">&quot;concatenating 300 000 times&quot;</span><span class="token plain"> </span><span class="token facet" style="color:rgb(154,72,71)">repeat:</span><span class="token number" style="color:rgb(125,125,125)">10</span><span class="token plain">  {</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">			</span><span class="token statement" style="color:rgb(127,0, 85);font-style:bold">do</span><span class="token plain"> </span><span class="token variable" style="color:rgb(28,125,180)">concatenate_string</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(125,125,125)">300000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain">			</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">		</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#282A36"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>On the same computer as in the previous example I get those results:</p>
<table><thead><tr><th style="text-align:right">number of concatenations</th><th style="text-align:center">100 000 characters</th><th style="text-align:center">200 000 characters</th><th style="text-align:center">300 000 characters</th></tr></thead><tbody><tr><td style="text-align:right"><strong>duration</strong></td><td style="text-align:center">15 ms</td><td style="text-align:center">35 ms</td><td style="text-align:center">45 ms</td></tr></tbody></table>
<p>Now let&#x27;s compare them:</p>
<table><thead><tr><th style="text-align:right">number of concatenations</th><th style="text-align:center">100 000 characters</th><th style="text-align:center">200 000 characters</th><th style="text-align:center">300 000 characters</th></tr></thead><tbody><tr><td style="text-align:right"><strong>duration initial approach</strong></td><td style="text-align:center">619 ms</td><td style="text-align:center">2563 ms</td><td style="text-align:center">5749 ms</td></tr><tr><td style="text-align:right"><strong>duration using concatenate</strong></td><td style="text-align:center">15 ms</td><td style="text-align:center">35 ms</td><td style="text-align:center">45 ms</td></tr></tbody></table>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/8a02a277-6f96-404a-ad0d-01df23bc3696" alt="image" class="img_ev3q"></p>
<p>Not only it is orders of magnitude faster, but it is also growing linearly instead of exponentially which is more sustainable in case I want to concatenate even bigger strings in the future.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="threads">Threads<a href="#threads" class="hash-link" aria-label="Direct link to Threads" title="Direct link to Threads">â€‹</a></h2>
<p>Since GAMA 1.9.1, a new skill has been added to implement <a href="/wiki/BuiltInSkills#thread">threads</a> in agents. The idea is not to give full control of threads to parallelize operations inside the simulation (though this could be achieved too), but to provide a way to communicate with the outside without blocking the execution of your simulation.
GAMA simulation running mostly on one thread, having some heavy asynchronous operation running in a separate thread could greatly improve the simulation time, for example you can use threads to push the state of your simulation to an external web API every 10 minutes.</p>
<blockquote>
<p>[!Note]
Using threads to interact with your simulation could completely break its reproducibility in a similar way as it is explained in <a href="#parallel">the parallel section</a>.</p>
</blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/gama-platform/gama/wiki/OptimizingModels/_edit" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/wiki/AnalysingCodePerformance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Analysing code performance</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/wiki/MultiParadigmModeling"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Multi-Paradigm Modeling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scheduling" class="table-of-contents__link toc-highlight">Scheduling</a></li><li><a href="#grid" class="table-of-contents__link toc-highlight">Grid</a><ul><li><a href="#optimization-facets" class="table-of-contents__link toc-highlight">Optimization Facets</a></li><li><a href="#parallel-execution" class="table-of-contents__link toc-highlight">Parallel execution</a></li><li><a href="#use-of-field-instead-of-grids" class="table-of-contents__link toc-highlight">Use of <code>field</code> instead of grids</a></li></ul></li><li><a href="#operators" class="table-of-contents__link toc-highlight">Operators</a><ul><li><a href="#list-operators" class="table-of-contents__link toc-highlight">List operators</a></li><li><a href="#spatial-operators" class="table-of-contents__link toc-highlight">Spatial operators</a></li></ul></li><li><a href="#displays" class="table-of-contents__link toc-highlight">Displays</a><ul><li><a href="#shape" class="table-of-contents__link toc-highlight">shape</a></li><li><a href="#circle-vs-square--sphere-vs-cube" class="table-of-contents__link toc-highlight">circle vs square / sphere vs cube</a></li><li><a href="#opengl-refresh-facets" class="table-of-contents__link toc-highlight">OpenGL refresh facets</a></li></ul></li><li><a href="#manipulating-containers-and-species" class="table-of-contents__link toc-highlight">Manipulating containers and species</a><ul><li><a href="#parallel" class="table-of-contents__link toc-highlight">parallel</a></li><li><a href="#iterating-over-containers" class="table-of-contents__link toc-highlight">Iterating over containers</a></li></ul></li><li><a href="#big-string-manipulation" class="table-of-contents__link toc-highlight">Big string manipulation</a></li><li><a href="#threads" class="table-of-contents__link toc-highlight">Threads</a></li></ul></div></div></div><br></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://github.com/gama-platform" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i> Github <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.facebook.com/GamaPlatform/" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook"></i> Facebook <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.linkedin.com/company/gama-platform" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin"></i> LinkedIn <i class="fa fa-arrow-up-right-from-square"></i></a></li><li class="footer__item"><a class="footer__link-item" href="https://www.youtube.com/channel/UCWJ1kWGDDI-9u2f2uD0gcaQ" target="_blank" rel="noopener noreferrer"><i class="fab fa-youtube"></i> Youtube <i class="fa fa-arrow-up-right-from-square"></i></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Mailing list</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="https://groups.google.com/forum/#!forum/gama-platform" target="_blank"><i class="fas fa-envelope"></i> For Users<br>gama-platform@googlegroups.com</a></li><li class="footer__item"><a class="footer__link-item" href="https://groups.google.com/forum/#!forum/gama-dev" target="_blank"><i class="fas fa-envelope"></i> For Developers<br>gama-dev@googlegroups.com</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Licence</div><ul class="footer__items clean-list"><li class="footer__item">
                  <p>
                    Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
                  </p>
                </li><li class="footer__item">
                  <p>A copy of the license is included <a href="https://github.com/gama-platform/gama/wiki/LICENSE.md" style="display:initial">here</a>, in the repository of the wiki content.</p>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/gama-logo.png" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/gama-logo.png" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright (C) - 2025 GAMA Platform.</div></div></div></footer></div>
</body>
</html>