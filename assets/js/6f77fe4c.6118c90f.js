"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1836],{44217:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>r,contentTitle:()=>l,default:()=>_,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var i=t(85893),o=t(11151);const a={title:"5. Norms, obligation, and enforcement"},l=void 0,s={id:"BDIAgents_step5",title:"5. Norms, obligation, and enforcement",description:"This last step consists of adding social norms, obligations, and enforcement into the agents' behavior.",source:"@site/versioned_docs/version-1.8.1/BDIAgents_step5.md",sourceDirName:".",slug:"/BDIAgents_step5",permalink:"/wiki/1.8.1/BDIAgents_step5",draft:!1,unlisted:!1,editUrl:"https://github.com/gama-platform/gama/wiki/BDIAgents_step5/_edit",tags:[],version:"1.8.1",frontMatter:{title:"5. Norms, obligation, and enforcement"},sidebar:"tuto",previous:{title:"4. Emotions and Personality",permalink:"/wiki/1.8.1/BDIAgents_step4"}},r={},d=[{value:"Formulation",id:"formulation",level:2},{value:"Norms, obligations, and enforcement",id:"norms-obligations-and-enforcement",level:2},{value:"Model Definition",id:"model-definition",level:2},{value:"law",id:"law",level:3},{value:"norms",id:"norms",level:3},{value:"Enforcement of the social norm",id:"enforcement-of-the-social-norm",level:3},{value:"Definition of policeman species",id:"definition-of-policeman-species",level:3},{value:"Modification of the chart",id:"modification-of-the-chart",level:3},{value:"Complete Model",id:"complete-model",level:2}];function c(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"This last step consists of adding social norms, obligations, and enforcement into the agents' behavior."}),"\n",(0,i.jsx)(e.h2,{id:"formulation",children:"Formulation"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Definition of the policeman species"}),"\n",(0,i.jsx)(e.li,{children:"Definition of the enforcement done by policeman species"}),"\n",(0,i.jsx)(e.li,{children:"Definition of the law agents have to follow"}),"\n",(0,i.jsx)(e.li,{children:"Definition of a gold miner norm to fulfill its obligation and its social norms"}),"\n",(0,i.jsx)(e.li,{children:"Definition of the enforcement done by gold miners"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"norms-obligations-and-enforcement",children:"Norms, obligations, and enforcement"}),"\n",(0,i.jsx)(e.p,{children:"The BDI architecture of GAMA allows defining explicit social norms, laws that lead to obligations and an enforcement process to sanction or reward the other agent depending on their behavior toward norms.\nA social norm is a set of actions executed under certain conditions which are known by the people has the right things to do in that condition. As it is, it can be assimilated into a plan. However, a norm can be violated which mean an agent chose to disobey and do not execute it while it should. To do this, each agent has an obedient value, between 0 and 1 ad computed from its personality and each norm has a threshold. If the obedient value of the agent is above the threshold, the norm is executed."}),"\n",(0,i.jsx)(e.p,{children:"An obligation is a mental state that can be assimilated with a desire. It is created by a law that indicates under which conditions the agent has to follow a particular obligation. Once again, the law can have a threshold value to be activated or not depending on the obedient value of the agent. If an agent has an obligation, it will give up its current intention and current plan to get this obligation as its intention. Then, it will choose a specific norm to answer this obligation, once again with a threshold on the obedient value."}),"\n",(0,i.jsx)(e.p,{children:"Finally, an enforcement mechanism can be defined during the perception process. Norms, laws, and obligation can be enforced. If a violation is detected, a sanction can be executed. If the norm/law/obligation is fulfilled, a reward can be executed."}),"\n",(0,i.jsx)(e.h2,{id:"model-definition",children:"Model Definition"}),"\n",(0,i.jsx)(e.h3,{id:"law",children:"law"}),"\n",(0,i.jsx)(e.p,{children:"We add a law to the gold miner species that will create the obligation to get gold if a gold nugget is perceived. This law replaces a rule and expresses the fact that miners are working or not, depending on their obedience value."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"species miner skills: [moving] control:simple_bdi {\n    ...\n    law working belief: mine_location new_obligation: has_gold \n       when:not has_obligation(has_gold) and not has_belief(has_gold) strength: 2.0 threshold: threshold_aw;\n\t\n        ...\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"norms",children:"norms"}),"\n",(0,i.jsx)(e.p,{children:"The miners will have two norms. A first one to answer the obligation to collect gold. This norm replaces the previous plan created for this purpose. However, a new plan is declared to get 3 pieces of gold at each time. This plan will be considered illegal by the policeman species."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'species miner skills: [moving] control: simple_bdi {\n    ...\n    norm doing_job obligation: has_gold finished_when: has_belief(has_gold) threshold: threshold_obligation {\n\tif (target = nil) {\n\t    do add_subintention(has_gold,choose_gold_mine, true);\n\t    do current_intention_on_hold();\n\t} else {\n\t    do goto target: target ;\n\t    if (target = location)  {\n\t\tgold_mine current_mine<- gold_mine first_with (target = each.location);\n\t\tif current_mine.quantity > 0 {\n\t\t    gold_transported <- gold_transported+1;\n\t\t    do add_belief(has_gold);\n\t\t    ask current_mine {quantity <- quantity - 1;}\t\n\t\t} else {\n\t\t    do add_belief(new_predicate(empty_mine_location, ["location_value"::target]));\n\t\t    do remove_belief(new_predicate(mine_at_location, ["location_value"::target]));\n\t\t}\n\t\ttarget <- nil;\n\t    }\n\t}\t\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"The second norm is a social norm to communicate the list of known mines to one's friends. It replaces the previous plan that did this action, while a new plan is added to give a wrong list of mines to one's friend."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"species miner skills: [moving] control: simple_bdi {\n    ...\n    norm share_information intention: share_information threshold: threshold_norm instantaneous: true {\n\tlist<miner> my_friends <- list<miner>((social_link_base where (each.liking > 0)) collect each.agent);\n\tloop known_gold_mine over: get_beliefs_with_name(mine_at_location) {\n\t    ask my_friends {\n\t\tdo add_belief(known_gold_mine);\n\t    }\n\t}\n\tloop known_empty_gold_mine over: get_beliefs_with_name(empty_mine_location) {\n\t    ask my_friends {\n\t\tdo add_belief(known_empty_gold_mine);\n\t    }\n\t}\n\t\t\n\tdo remove_intention(share_information, true); \n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"enforcement-of-the-social-norm",children:"Enforcement of the social norm"}),"\n",(0,i.jsx)(e.p,{children:"Finally, for the gold-miner agent, an enforcement is defined about the social norm to communicate the location of mines to other agents. A sanction and a reward are declared to change the liking value with the agent controlled, depending on if the norm is violated or fulfilled."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'species miner skills: [moving] control:simple_bdi {\n    ...\n    perceive target: miner in: view_dist {\n\tmyself.agent_perceived <- self;\n\tenforcement norm:"share_information" sanction:"sanction_to_norm" reward:"reward_to_norm";\n    }\n\t\t\n    sanction sanction_to_norm{\n\tdo change_liking(agent_perceived,-0.1);\n    }\t\n\t\n    sanction reward_to_norm{\n\tdo change_liking(agent_perceived,0.1);\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"definition-of-policeman-species",children:"Definition of policeman species"}),"\n",(0,i.jsx)(e.p,{children:"Finally, we define a policeman species that will wander through the map and enforce the miners about the law and the obligation. The sanctions will be a fine collected by policemen."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'species policeman skills: [moving] control:simple_bdi {\n    predicate patroling <- new_predicate("patrolling");\n    float view_dist <- 1000.0;\n    miner agent_perceived <- nil;\n\t\n    init {\n\tdo add_desire(patroling);\n    }\n\t\n    perceive target:miner in: view_dist {\n\tmyself.agent_perceived <- self;\n\tenforcement law: "working" sanction: "sanction_to_law";\n\tenforcement obligation: has_gold sanction: "sanction_to_obligation" reward: "reward_to_obligation";\n    }\n\t\n    sanction sanction_to_law {\n\task agent_perceived{\n\t    threshold_law <- 0.0;\n\t    gold_sold <- gold_sold-5;\n\t}\n\tfine <- fine +5;\n    }\n\t\n    sanction sanction_to_obligation {\n\task agent_perceived{\n\t    gold_sold <- gold_sold-3;\n\t    do remove_intention(sell_gold,true);\n\t    thresholdObligation <- self.threshold_obligation - 0.1;\n\t}\n\tfine <- fine + 3;\n    }\n\t\n    sanction reward_to_obligation{\n\task agent_perceived{\n\t    gold_sold <- gold_sold+2;\n\t}\n\tfine <- fine - 2;\n    }\n\t\n    plan patrol intention: patroling{\n\tdo wander;\n    }\n\t\n    aspect base{\n\tdraw circle(view_dist) color: #blue depth:0.0;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"modification-of-the-chart",children:"Modification of the chart"}),"\n",(0,i.jsx)(e.p,{children:"We add to the output chart displayed the data coming from the policeman."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'display chart {\n\t    chart "Money" type: series {\n\t\tdatalist legend: miner accumulate each.name value: miner accumulate each.gold_sold color: miner accumulate each.my_color;\n                data "policeman" value: fine color: #red;\n\t\t}\n\t}\n\n'})}),"\n",(0,i.jsx)(e.h2,{id:"complete-model",children:"Complete Model"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'model BDItutorial5\n\nglobal {\n    int nb_mines <- 10; \n    int nb_miners <- 5;\n    int nb_police <- 1;\n    int fine <- 0;\n    market the_market;\n    \n    string mine_at_location <- "mine_at_location";\n    string empty_mine_location <- "empty_mine_location";\n    \n    float step <- 10#mn;\n    \n    //possible predicates concerning miners\n    predicate mine_location <- new_predicate(mine_at_location) ;\n    predicate choose_gold_mine <- new_predicate("choose a gold mine");\n    predicate has_gold <- new_predicate("extract gold");\n    predicate find_gold <- new_predicate("find gold") ;\n    predicate sell_gold <- new_predicate("sell gold") ;\n    predicate share_information <- new_predicate("share information") ;\n    \n    \n    emotion joy <- new_emotion("joy");\n    \n    float inequality <- 0.0 update:standard_deviation(miner collect each.gold_sold);\n    \n    geometry shape <- square(20 #km);\n    init\n    {\n        create market {\n            the_market <- self;    \n        }\n        create gold_mine number:nb_mines;\n        create miner number:nb_miners;\n        create policeman number:nb_police;\n    }\n    \n    reflex display_social_links{\n\t\tloop tempMiner over: miner{\n\t\t\t\tloop tempDestination over: tempMiner.social_link_base{\n\t\t\t\t\tif (tempDestination !=nil){\n\t\t\t\t\t\tbool exists<-false;\n\t\t\t\t\t\tloop tempLink over: socialLinkRepresentation{\n\t\t\t\t\t\t\tif((tempLink.origin=tempMiner) and (tempLink.destination=tempDestination.agent)){\n\t\t\t\t\t\t\t\texists<-true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(not exists){\n\t\t\t\t\t\t\tcreate socialLinkRepresentation number: 1{\n\t\t\t\t\t\t\t\torigin <- tempMiner;\n\t\t\t\t\t\t\t\tdestination <- tempDestination.agent;\n\t\t\t\t\t\t\t\tif(get_liking(tempDestination)>0){\n\t\t\t\t\t\t\t\t\tmy_color <- #green;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmy_color <- #red;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t}\n\n    reflex end_simulation when: sum(gold_mine collect each.quantity) = 0 and empty(miner where each.has_belief(has_gold)){\n        do pause;\n        ask miner {\n            write name + " : " +gold_sold;\n        }\n        write "**********************";\n        write "fine : " + fine;\n    }\n}\n\nspecies gold_mine {\n    int quantity <- rnd(1,20);\n    aspect default {\n        draw triangle(200 + quantity * 50) color: (quantity > 0) ? #yellow : #gray border: #black;    \n    }\n}\n\nspecies market {\n    int golds;\n    aspect default {\n      draw square(1000) color: #black ;\n    }\n}\n\nspecies policeman skills: [moving] control:simple_bdi {\n    predicate patroling <- new_predicate("patrolling");\n    float view_dist <- 1000.0;\n    miner agent_perceived <- nil;\n    \n    init {\n        do add_desire(patroling);\n    }\n    \n    perceive target: miner in: view_dist {\n        enforcement law:"working" sanction:"sanction_to_law";\n        enforcement obligation:has_gold /*when:has_belief(has_gold)*/ sanction: "sanction_to_obligation" reward:"reward_to_obligation";\n    }\n    \n    sanction sanction_to_law{\n        ask agent_perceived{\n            threshold_law <- 0.0;\n            gold_sold <- gold_sold-5;\n        }\n        fine <- fine +5;\n    }\n    \n    sanction sanction_to_obligation {\n        ask agent_perceived{\n            gold_sold <- gold_sold-3;\n            do remove_intention(sell_gold,true);\n            threshold_obligation <- self.threshold_obligation - 0.1;\n        }\n        fine <- fine + 3;\n    }\n    \n    sanction reward_to_obligation{\n        ask agent_perceived{\n            gold_sold <- gold_sold+2;\n        }\n        fine <- fine -2;\n    }\n    \n    plan patrol intention: patroling {\n        do wander;\n    }\n    \n    aspect base {\n        draw circle(view_dist) color: #blue depth: 0.0;\n    }\n}\n\nspecies miner skills: [moving] control:simple_bdi {\n    \n    float view_dist<-1000.0;\n    float speed <- 2#km/#h;\n    rgb my_color<-rnd_color(255);\n    point target;\n    int gold_sold;\n    int gold_transported<-0;\n    agent agent_perceived<-nil;\n    \n    bool use_social_architecture <- true;\n    bool use_emotions_architecture <- true;\n    bool use_personality <- true;\n    \n    float openness <- gauss(0.5,0.12);\n    float conscientiousness <- gauss(0.5,0.12);\n    float extraversion <- gauss(0.5,0.12);\n    float agreeableness <- gauss(0.5,0.12);\n    float neurotism <- gauss(0.5,0.12);\n    \n    float plan_persistence <- 1.0;\n    float intention_persistence <- 1.0;\n    \n    float threshold_law <- 1.0;\n    float threshold_obligation <- 1.0;\n    float threshold_norm <- 0.5;\n    \n    init {\n        do add_desire(find_gold);\n    }\n    \n    perceive target: self {\n        if(gold_transported>0) {\n            do add_belief(has_gold);\n        } else {\n            do remove_belief(has_gold);\n        }\n    }\n    \n    perceive target: miner in: view_dist {\n        myself.agent_perceived <- self;\n        socialize liking: point(my_color.red, my_color.green, my_color.blue) distance_to point(myself.my_color.red, myself.my_color.green, myself.my_color.blue) / ( 255) - 1;\n        enforcement norm:"share_information" sanction:"sanction_to_norm" reward:"reward_to_norm";\n    }\n        \n    sanction sanction_to_norm {\n        do change_liking(agent_perceived,-0.1);\n    }    \n    \n    sanction reward_to_norm {\n        do change_liking(agent_perceived,0.1);\n    }\n        \n    perceive target: gold_mine where (each.quantity > 0) in: view_dist {\n        focus id:mine_at_location var:location;\n        ask myself {\n            if (has_emotion(joy)) {\n                write self.name + " is joyous";\n                do add_desire(predicate:share_information, strength: 5.0);\n            }\n            do remove_intention(find_gold, false);\n        }\n    }\n    \n    rule belief: has_gold new_desire: sell_gold strength: 3.0;\n    \n    law working belief: mine_location new_obligation: has_gold when:not has_obligation(has_gold) and not has_belief(has_gold) strength: 2.0 threshold:threshold_law;\n    \n    plan lets_wander intention:find_gold \n    {\n        do wander;\n    }\n    \n    norm doing_job obligation:has_gold finished_when: has_belief(has_gold) threshold:threshold_obligation{\n        if (target = nil) {\n            do add_subintention(get_current_intention(),choose_gold_mine, true);\n            do current_intention_on_hold();\n        } else {\n            do goto target: target ;\n            if (target = location)  {\n                gold_mine current_mine<- gold_mine first_with (target = each.location);\n                if current_mine.quantity > 0 {\n                    gold_transported <- gold_transported+1;\n                     do add_belief(has_gold);\n                    ask current_mine {quantity <- quantity - 1;}    \n                } else {\n                    do add_belief(new_predicate(empty_mine_location, ["location_value"::target]));\n                    do remove_belief(new_predicate(mine_at_location, ["location_value"::target]));\n                }\n                target <- nil;\n            }\n        }    \n    }\n    \n    plan get_more_gold intention: has_gold {\n        if (target = nil) {\n            do add_subintention(get_current_intention(),choose_gold_mine, true);\n            do current_intention_on_hold();\n        } else {\n            do goto target: target ;\n            if (target = location)  {\n                gold_mine current_mine<- gold_mine first_with (target = each.location);\n                if current_mine.quantity > 0 {\n                    gold_transported <- 3;\n                     do add_belief(has_gold);\n                    ask current_mine {if(quantity>=3) {\n                        quantity <- quantity - 3;\n                    }else {\n                        quantity <- 0;\n                    } \n                    }    \n                } else {\n                    do add_belief(new_predicate(empty_mine_location, ["location_value"::target]));\n                    do remove_belief(new_predicate(mine_at_location, ["location_value"::target]));\n                }\n                target <- nil;\n            }\n        }    \n    }\n    \n    plan choose_closest_gold_mine intention: choose_gold_mine instantaneous: true{\n        list<point> possible_mines <- get_beliefs_with_name(mine_at_location) collect (point(get_predicate(mental_state (each)).values["location_value"]));\n        list<point> empty_mines <- get_beliefs_with_name(empty_mine_location) collect (point(get_predicate(mental_state (each)).values["location_value"]));\n        possible_mines <- possible_mines - empty_mines;\n        if (empty(possible_mines)) {\n            do remove_intention(has_gold, true); \n        } else {\n            target <- (possible_mines with_min_of (each distance_to self)).location;\n        }\n        do remove_intention(choose_gold_mine, true); \n    }\n    \n    plan return_to_base intention: sell_gold when: has_belief(has_gold){\n        do goto target: the_market ;\n        if (the_market.location = location)  {\n            do remove_belief(has_gold);\n            do remove_intention(sell_gold, true);\n            gold_sold <- gold_sold + gold_transported;\n            gold_transported <- 0;\n        }\n    }\n    \n    norm share_information intention:share_information threshold:threshold_norm instantaneous: true{\n        list<miner> my_friends <- list<miner>((social_link_base where (each.liking > 0)) collect each.agent);\n        loop known_gold_mine over: get_beliefs_with_name(mine_at_location) {\n            ask my_friends {\n                do add_belief(known_gold_mine);\n            }\n        }\n        loop known_empty_gold_mine over: get_beliefs_with_name(empty_mine_location) {\n            ask my_friends {\n                do add_belief(known_empty_gold_mine);\n            }\n        }\n        \n        do remove_intention(share_information, true); \n    }\n    \n    plan share_information_to_friends intention: share_information instantaneous: true{\n        list<miner> my_friends <- list<miner>((social_link_base where (each.liking > 0)) collect each.agent);\n        loop known_gold_mine over: get_beliefs_with_name(empty_mine_location) {\n            ask my_friends {\n                do add_belief(known_gold_mine);\n            }\n        }        \n        do remove_intention(share_information, true); \n    }\n\n    aspect default {\n      draw circle(200) color: my_color border: #black depth: gold_sold;\n    }\n}\n\nspecies socialLinkRepresentation{\n\tminer origin;\n\tagent destination;\n\trgb my_color;\n\t\n\taspect base{\n\t\tdraw line([origin,destination],50.0) color: my_color;\n\t}\n}\n\nexperiment GoldBdi type: gui {\n    output {\n        display map type: opengl {\n            species market ;\n            species gold_mine ;\n            species miner;\n            species policeman aspect:base;\n        }    \n\n        display socialLinks type: opengl{\n\t\tspecies socialLinkRepresentation aspect: base;\n\t}\n\n        display chart {\n\t    chart "Money" type: series {\n\t\tdatalist legend: miner accumulate each.name value: miner accumulate each.gold_sold color: miner accumulate each.my_color;\n                data "policeman" value: fine color: #red;\n\t\t}\n\t}\n\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"BDIAgents",children:"Back to the start of the tutorial"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"BDIAgents_step1",children:"Creation of the basic model: gold mines and market"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"BDIAgents_step2",children:"Definition of the BDI miners"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"BDIAgents_step3",children:"Definition of social relations between miners"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"BDIAgents_step4",children:"Use of emotions and personality for the miners"})}),"\n"]})]})}function _(n={}){const{wrapper:e}={...(0,o.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}},11151:(n,e,t)=>{t.d(e,{Z:()=>s,a:()=>l});var i=t(67294);const o={},a=i.createContext(o);function l(n){const e=i.useContext(a);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:l(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);