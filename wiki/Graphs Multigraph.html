<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Multigraph · GAMA-Platform</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="[//]: # (keyword|operator_path_between)"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Multigraph · GAMA-Platform"/><meta property="og:type" content="website"/><meta property="og:url" content="https://gama-platform.github.io/"/><meta property="og:description" content="[//]: # (keyword|operator_path_between)"/><meta property="og:image" content="https://gama-platform.github.io//resources/images/general/GamaPlatform.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://gama-platform.github.io//resources/images/general/GamaPlatform.png"/><link rel="shortcut icon" href="/img/gama-logo.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://gama-platform.github.io/blog/atom.xml" title="GAMA-Platform Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://gama-platform.github.io/blog/feed.xml" title="GAMA-Platform Blog RSS Feed"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.4.4/fuse.min.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script type="text/javascript" src="/js/searchEngine.js"></script><script type="text/javascript" src="/js/dark.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/gama-logo_white.png" alt="GAMA-Platform"/><h2 class="headerTitleWithLogo">GAMA-Platform</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/wiki/Home" target="_self">Documentation</a></li><li class=""><a href="/wiki/Tutorials" target="_self">Tutorials</a></li><li class=""><a href="/download" target="_self">Download</a></li><li class=""><a href="/wiki/Contribute" target="_self">Contribute</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class=""><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Multigraph</h1></header><article><div><span><p><em>Author : Patrick Taillandier</em></p>
<p>This model shows how to build a graph on which people agents will move with GIS Shapefile, but also to generate an other graph representing the friendship between the people agents, people agents trying to be closer spatially to each other</p>
<p>Code of the model :</p>
<pre><code class="hljs">
<span class="hljs-builtin">model</span> multigraph

global {
    <span class="hljs-literal">file</span> shape_file_in &lt;- <span class="hljs-literal">file</span>(<span class="hljs-string">'../includes/road.shp'</span>) ;
    <span class="hljs-literal">file</span> shape_file_bounds &lt;- <span class="hljs-literal">file</span>(<span class="hljs-string">'../includes/bounds.shp'</span>) ;
    <span class="hljs-literal">geometry</span> shape &lt;- envelope(shape_file_bounds);
    
    <span class="hljs-comment">//spatial graph representing the road network</span>
    <span class="hljs-literal">graph</span> road_graph; 
    
    <span class="hljs-comment">//social graph (not spatial) representing the frienship links between people</span>
    <span class="hljs-literal">graph</span> friendship_graph &lt;- <span class="hljs-literal">graph</span>([]);
    
    init {
        <span class="hljs-keyword">create</span> road <span class="hljs-symbol">from:</span> shape_file_in;
        
        <span class="hljs-comment">//creation of th road graph from the road agents</span>
        road_graph &lt;- as_edge_graph(road);
        
        <span class="hljs-comment">//creation of 50 people agent, and add each people agent as a node in the friendship graph</span>
        <span class="hljs-keyword">create</span> people <span class="hljs-symbol">number:</span> 50 {
            <span class="hljs-keyword">add</span> node(self) <span class="hljs-symbol">to:</span> friendship_graph;
        }
        
        <span class="hljs-comment">//creation of 50 friendship link between people agents</span>
        <span class="hljs-keyword">loop</span> <span class="hljs-symbol">times:</span> 50 {
            people p1 &lt;- one_of(people);
            people p2 &lt;- one_of(<span class="hljs-literal">list</span>(people) - p1);
            <span class="hljs-keyword">create</span> friendship_link  {
                <span class="hljs-keyword">add</span> edge (p1, p2, self) <span class="hljs-symbol">to:</span> friendship_graph;
                shape &lt;- link(p1,p2);
            }
        }
    }
}

<span class="hljs-literal">species</span> people <span class="hljs-symbol">skills:</span> [<span class="hljs-builtin">moving</span>]{
    <span class="hljs-literal">point</span> location &lt;- any_location_in(one_of(road));
    people target_people &lt;- one_of(people);
    <span class="hljs-literal">point</span> target &lt;- target_people.location;
    <span class="hljs-literal">float</span> size &lt;- 3.0;
    
    <span class="hljs-comment">//action that make recompute the size of the agents as the distance between it and its target people in the friendship graph (the farthest, the biggest)</span>
    <span class="hljs-keyword">action</span> updateSize {
        <span class="hljs-literal">path</span> friendship_path &lt;- path_between(friendship_graph,self,target_people);
        <span class="hljs-keyword">if</span> (friendship_path != nil) {
            size &lt;-max([2,length( friendship_path.edges)]) as <span class="hljs-literal">float</span>;
        }
    }
    
    <span class="hljs-comment">//the agent moves toward its target, when reaching it, it chooses another target as the location of one of the people agent</span>
    <span class="hljs-builtin">reflex</span> movement {
        <span class="hljs-keyword">if</span> (location distance_to target &lt; 5.0) {
            target_people &lt;- one_of(people);
            target &lt;- target_people.location;
            <span class="hljs-keyword">do</span> updateSize;
        }
        <span class="hljs-keyword">do</span> goto <span class="hljs-symbol">on:</span>road_graph <span class="hljs-symbol">target:</span>target <span class="hljs-symbol">speed:</span>1 + rnd(2);
    }
    <span class="hljs-keyword">aspect</span> <span class="hljs-keyword">default</span> {
        <span class="hljs-keyword">draw</span> circle(size) <span class="hljs-symbol">color:</span> #red;
    }   
}
    
<span class="hljs-literal">species</span> friendship_link {
    
    <span class="hljs-keyword">aspect</span> <span class="hljs-keyword">default</span> {
        <span class="hljs-keyword">draw</span> shape <span class="hljs-symbol">color:</span> #blue;
    }
}
    
<span class="hljs-literal">species</span> road  {
    <span class="hljs-keyword">aspect</span> <span class="hljs-keyword">default</span> {
        <span class="hljs-keyword">draw</span> shape <span class="hljs-symbol">color:</span>#black ;
    }
} 


<span class="hljs-builtin">experiment</span> multigraph <span class="hljs-symbol">type:</span> gui {
    <span class="hljs-keyword">output</span> {
        <span class="hljs-keyword">display</span> friendship <span class="hljs-symbol">type:</span> opengl{
            <span class="hljs-literal">species</span> road ;
            <span class="hljs-literal">species</span> friendship_link ;
            <span class="hljs-literal">species</span> people;
        }
    }
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" style="margin-bottom:0"><a href="/" class="nav-home"><img src="/img/gama-logo.png" alt="GAMA-Platform" width="66" height="58"/></a><div><h5>Networks</h5><a href="https://github.com/gama-platform"><i class="fab fa-github"></i> GitHub</a><a href="https://www.facebook.com/GamaPlatform/" target="_blank"><i class="fab fa-facebook"></i> Facebook</a><a href="https://twitter.com/gamaplatform" target="_blank"><i class="fab fa-twitter"></i> Twitter</a><a href="https://www.linkedin.com/company/gama-platform" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn</a><a href="https://www.youtube.com/channel/UCWJ1kWGDDI-9u2f2uD0gcaQ" target="_blank"><i class="fab fa-youtube"></i> Youtube</a><a href="https://gama-platform.github.io/blog/feed" target="_blank"><i class="fa fa-rss"></i> Blog RSS</a></div><div style="flex-grow:2"><h5>Mailing list</h5><a href="https://groups.google.com/forum/#!forum/gama-platform" target="_blank"><i class="fas fa-envelope"></i> For Users<br/>gama-platform@googlegroups.com</a><a href="https://groups.google.com/forum/#!forum/gama-dev" target="_blank"><i class="fas fa-envelope"></i> For Developers<br/>gama-dev@googlegroups.com</a></div><div style="color:hsla(0,0%,100%,.4);flex-grow:3"><h5>License</h5><p>Copyright (C) - 2020 GAMA-Platform.</p><p>Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.</p><p>A copy of the license is included <a href="https://github.com/gama-platform/gama/wiki/LICENSE.md" style="display:initial">here</a>, in the repository of the wiki content.</p></div></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.fbAsyncInit = function() {FB.init({appId:'524881055001796',xfbml:true,version:'v2.7'});};(function(d, s, id){var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) {return;}js = d.createElement(s); js.id = id;js.src = '//connect.facebook.net/en_US/sdk.js';fjs.parentNode.insertBefore(js, fjs);}(document, 'script','facebook-jssdk'));
                </script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'undefined',
                indexName: 'undefined',
                inputSelector: '#search_input_react'
              });
            </script></body></html>