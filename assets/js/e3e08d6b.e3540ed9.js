"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[56856],{50278:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"DefiningExportFiles","title":"Defining export files","description":"The Save Statement","source":"@site/versioned_docs/version-1.9.3/DefiningExportFiles.md","sourceDirName":".","slug":"/DefiningExportFiles","permalink":"/wiki/DefiningExportFiles","draft":false,"unlisted":false,"editUrl":"https://github.com/gama-platform/gama/wiki/DefiningExportFiles/_edit","tags":[],"version":"1.9.3","frontMatter":{"title":"Defining export files"},"sidebar":"main","previous":{"title":"Defining monitors and inspectors","permalink":"/wiki/DefiningMonitorsAndInspectors"},"next":{"title":"Defining user interaction","permalink":"/wiki/DefiningUserInteraction"}}');var s=i(74848),a=i(28453);const o={title:"Defining export files"},r=void 0,l={},c=[{value:"The Save Statement",id:"the-save-statement",level:2},{value:"Facets",id:"facets",level:3},{value:"Usages",id:"usages",level:3},{value:"Export files in an experiment",id:"export-files-in-an-experiment",level:2},{value:"Autosave",id:"autosave",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"the-save-statement",children:"The Save Statement"}),"\n",(0,s.jsxs)(t.p,{children:['Allows to save data in a file. The type of file can be "shp", "json" and "kml" for vector spatial data (agents and geometries), "asc" and "geotiff" for raster spatial data (grid), "image" for image, "dimacs", "dot", "gexf", "graphml", "gml" and "graph6" for graphs, "text" and "csv". The ',(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"save"})})," statement can be use in an init block, a reflex, an action or in a user command."]}),"\n",(0,s.jsx)(t.h3,{id:"facets",children:"Facets"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"attributes"}),", optional, expects any type in [map, list] - Allows to specify the attributes of a shape file or GeoJson file where agents are saved. Can be expressed as a list of string or as a literal map. When expressed as a list, each value should represent the name of an attribute of the shape or agent. The keys of the map are the names of the attributes that will be present in the file, the values are whatever expressions needed to define their value."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"crs"}),', optional, expects any type - the name of the projection, e.g. crs:"EPSG:4326" or its EPSG id, e.g. crs:4326. ',(0,s.jsx)(t.a,{href:"http://spatialreference.org",children:"Here"})," a list of the CRS codes (and EPSG id)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"data"}),", optional, expects any type - the data that will be saved to the file"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"header"}),", optional, expects bool - an expression that evaluates to a boolean, specifying whether the save will write a header if the file does not exist"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"rewrite"}),', optional, expects bool - a boolean expression specifying whether to erase the file if it exists or append data at the end of it. Only applicable to "text" or "csv" files. Default is true']}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"to"}),", optional, expects string - an expression that evaluates to an string, the path to the file, or directly to a file"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"format"}),", optional, a string representing the format of the output file (e.g. ",(0,s.jsx)(t.code,{children:"shp"}),", ",(0,s.jsx)(t.code,{children:"asc"}),", ",(0,s.jsx)(t.code,{children:"geotiff"}),", ",(0,s.jsx)(t.code,{children:"png"}),", ",(0,s.jsx)(t.code,{children:"text"}),", ",(0,s.jsx)(t.code,{children:"csv"}),"). If the file extension is non ambiguous in facet 'to:', this format does not need to be specified. However, in many cases, it can be useful to do it (for instance, when saving a string to a .pgw file, it is always better to clearly indicate that the expected format is 'text')."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"type"}),", optional, deprecated, use ",(0,s.jsx)(t.code,{children:"format"})," instead."]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"usages",children:"Usages"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Its simple syntax is:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"save data to: output_file format: a_type_file;\n"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"To save data in a text file:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'save (string(cycle) + "->"  + name + ":" + location) to: "save_data.txt" format: text;\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"To save the values of some attributes of the current agent in csv file:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'save [name, location, host] to: "save_data.csv" format: csv;\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"To save the geometries of all the agents of a species into a shapefile or a geojson (with optional attributes):"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'save species_of(self) to: "save_shapefile.shp" format: shp attributes: [name::"nameAgent", location::"locationAgent"] crs: "EPSG:4326";\nsave species_of(self) to: "save_shapefile.geojson" format: json attributes: [name::"nameAgent", location::"locationAgent"] ;\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:'To save a grid into a geotiff or a asc file (the value considered will be the "grid_value" attribute of the cell):'}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'save cell to:"../results/grid.tif" format:geotiff;\nsave cell to:"../results/grid.asc" format:asc;\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"To save a grid into an image file:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'save cell to:"../results/grid.png" format:image;\n'})}),"\n",(0,s.jsxs)(t.admonition,{type:"info",children:[(0,s.jsx)(t.p,{children:"Relative path are processed from the gaml file where the experiment is located."}),(0,s.jsxs)(t.p,{children:["This might lead to some issues explained in ",(0,s.jsx)(t.a,{href:"https://github.com/gama-platform/gama-platform.github.io/issues/137",children:"#137"})," where relative path set in an imported file will be based on the model you are running and not the file you defined it."]})]}),"\n",(0,s.jsx)(t.h2,{id:"export-files-in-an-experiment",children:"Export files in an experiment"}),"\n",(0,s.jsxs)(t.p,{children:["When the modeler wants to save data at each simulation step, it is recommended to use the ",(0,s.jsx)(t.code,{children:"save"})," statement either in the model itself or in a ",(0,s.jsx)(t.code,{children:"reflex"})," of the ",(0,s.jsx)(t.code,{children:"experiment"})," (the syntax and the use are similar in all the cases)."]}),"\n",(0,s.jsxs)(t.p,{children:["The use of ",(0,s.jsx)(t.code,{children:"save"})," in ",(0,s.jsx)(t.code,{children:"experiment"})," is mandatory when we want to save a value related to several simulations running in parallel (e.g. the average of a value over several simulations). It is in particular in ",(0,s.jsxs)(t.a,{href:"BatchExperiments",children:[(0,s.jsx)(t.code,{children:"batch"})," experiments"]})," to save a value at the end of simulations."]}),"\n",(0,s.jsx)(t.h2,{id:"autosave",children:"Autosave"}),"\n",(0,s.jsxs)(t.p,{children:["Image files can be exported also through the ",(0,s.jsx)(t.code,{children:"autosave"})," facet of the display, as explained in ",(0,s.jsx)(t.a,{href:"DefiningDisplaysGeneralities#displays-and-layers",children:"this previous part"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>r});var n=i(96540);const s={},a=n.createContext(s);function o(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);