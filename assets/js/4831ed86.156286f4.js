"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[43040],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>d});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=p(a),d=i,h=c["".concat(s,".").concat(d)]||c[d]||u[d]||r;return a?n.createElement(h,o(o({ref:t},m),{},{components:a})):n.createElement(h,o({ref:t},m))}));function d(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},26640:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>s,default:()=>d,frontMatter:()=>l,metadata:()=>p,toc:()=>u});var n=a(87462),i=a(63366),r=(a(67294),a(3905)),o=["components"],l={title:"6. Exploration of the model"},s=void 0,p={unversionedId:"LuneraysFlu_step6",id:"LuneraysFlu_step6",title:"6. Exploration of the model",description:"This final step illustrates how to explore the model through the introduction of batch experiments.",source:"@site/../docs/LuneraysFlu_step6.md",sourceDirName:".",slug:"/LuneraysFlu_step6",permalink:"/wiki/next/LuneraysFlu_step6",draft:!1,editUrl:"https://github.com/gama-platform/gama/wiki/LuneraysFlu_step6/_edit",tags:[],version:"current",frontMatter:{title:"6. Exploration of the model"},sidebar:"tuto",previous:{title:"5. Definition of 3D displays",permalink:"/wiki/next/LuneraysFlu_step5"},next:{title:"BDI Agents",permalink:"/wiki/next/BDIAgents"}},m={},u=[{value:"Formulation",id:"formulation",level:2},{value:"Model Definition",id:"model-definition",level:2},{value:"Sensitivity analysis toward stochasticity",id:"sensitivity-analysis-toward-stochasticity",level:3},{value:"Exploration",id:"exploration",level:3},{value:"Calibration",id:"calibration",level:3},{value:"Complete Model",id:"complete-model",level:2}],c={toc:u};function d(e){var t=e.components,a=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This final step illustrates how to explore the model through the introduction of batch experiments."),(0,r.kt)("h2",{id:"formulation"},"Formulation"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add an experiment to launch 10 simulations to analyze the sensitivity toward stochasticity."),(0,r.kt)("li",{parentName:"ul"},"Add an experiment to explore the impact of the ",(0,r.kt)("inlineCode",{parentName:"li"},"proba_leave")," parameter."),(0,r.kt)("li",{parentName:"ul"},"Add an experiment to calibrate the model.")),(0,r.kt)("p",null,"These 3 additions will add each a new experiment of type batch, more details about ",(0,r.kt)("a",{parentName:"p",href:"BatchExperiments"},"batch experiment on this page"),"."),(0,r.kt)("h2",{id:"model-definition"},"Model Definition"),(0,r.kt)("h3",{id:"sensitivity-analysis-toward-stochasticity"},"Sensitivity analysis toward stochasticity"),(0,r.kt)("p",null,"The aim is to run many simulations with the default values for parameters to analyze the impact of stochasticity over the simulation results. We choose as indicator to compare the simulations the ",(0,r.kt)("inlineCode",{parentName:"p"},"infected_rate")," value after 2hours of simulations. We will launch 10 simulations and display the mean and standard deviation values of this variable over the 10 simulations."),(0,r.kt)("p",null,"To this purpose we need to define a new experiment with the following facet values:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"type"),": the type of the experiment, here we choose the ",(0,r.kt)("inlineCode",{parentName:"li"},"batch")," mode to be able to launch many simulations in one launch."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"until"),": the stop condition in the batch experiment, here ",(0,r.kt)("inlineCode",{parentName:"li"},"time > 2#h"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"repeat"),": the number of simulations to run with the same parameter values (number of replications), here 10.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'experiment test_robustness type: batch until: time > 2#h repeat: 10 {\n    reflex information {\n    list<float> vals <- simulations collect each.infected_rate;\n    write "mean: " + mean(vals) + " standard deviation: " + standard_deviation(vals);   \n    }\n}\n')),(0,r.kt)("p",null,"Experiments are also a kind of species. They can thus have variables and behaviors. Here we use the ",(0,r.kt)("inlineCode",{parentName:"p"},"simulations")," variable that is the list of the 10 simulations (for the 10 replications). In addition, in batch mode, a reflex is executed at the end of all the replication simulations. We can thus create the list of all the ",(0,r.kt)("inlineCode",{parentName:"p"},"infected_rate")," values (with the ",(0,r.kt)("inlineCode",{parentName:"p"},"collect")," operator) and compute the ",(0,r.kt)("inlineCode",{parentName:"p"},"mean")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"standard_deviation"),"."),(0,r.kt)("h3",{id:"exploration"},"Exploration"),(0,r.kt)("p",null,"The aim here is to explore the impact of one parameter over the simulations' results. We keep the same indicator. We add the ",(0,r.kt)("inlineCode",{parentName:"p"},"parameter")," to explore the ",(0,r.kt)("inlineCode",{parentName:"p"},"experiment")," and specify the possibility it can take with either the ",(0,r.kt)("inlineCode",{parentName:"p"},"among")," facet or the combination of ",(0,r.kt)("inlineCode",{parentName:"p"},"min"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"max"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"step")," facets."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'experiment explore_model type: batch until: time > 2#h repeat: 2 {\n    parameter "proba_leave" var: proba_leave among: [0, 0.01, 0.05, 0.1, 1.0];\n    \n    reflex save_results {\n    ask simulations {\n        write "proba_leave: " + proba_leave + " infected_rate: " + self.infected_rate;\n        save [proba_leave, self.infected_rate] type: csv to:"results.csv" rewrite: (int(self) = 0) ? true : false header: true ;\n    }\n    }\n}\n')),(0,r.kt)("p",null,"In order to do a deeper investigation, in particular with an external tool, it could be useful to save the values in a file. For this purpose, we use the ",(0,r.kt)("a",{parentName:"p",href:"Statements#save"},(0,r.kt)("inlineCode",{parentName:"a"},"save")," statement"),". In our example, we save a list of values in the csv file (",(0,r.kt)("inlineCode",{parentName:"p"},"type: csv"),") specified in the ",(0,r.kt)("inlineCode",{parentName:"p"},"to")," facet."),(0,r.kt)("h3",{id:"calibration"},"Calibration"),(0,r.kt)("p",null,"The calibration process corresponds to the search of parameter values that maximize/minimize indicators. To this purpose, we need to define:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"the parameters to explore, with their possible values,"),(0,r.kt)("li",{parentName:"ul"},"the indicator to minimize/maximize,"),(0,r.kt)("li",{parentName:"ul"},"the exploration method.")),(0,r.kt)("p",null,"Here we choose to minimize the value ",(0,r.kt)("inlineCode",{parentName:"p"},"abs(infected_rate - 0.5)")," (i.e. we want to find parameters' value that makes the simulation having an ",(0,r.kt)("inlineCode",{parentName:"p"},"infected_rate")," as close as possible to 0.5) after 2hours of simulation. The chosen optimization method is a genetic algorithm (",(0,r.kt)("a",{parentName:"p",href:"ExplorationMethods"},"more details on this page"),")."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'experiment calibration_model type: batch until: time > 2#h repeat: 3 {\n    parameter "infection distance" var: infection_distance min: 1.0 max: 20.0 step: 1;\n    parameter "proba infection" var: proba_infection min: 0.01 max: 1.0 step: 0.01;\n    \n    method genetic pop_dim: 3 max_gen: 5 minimize: abs(infected_rate - 0.5);\n}\n')),(0,r.kt)("h2",{id:"complete-model"},"Complete Model"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-gaml",metastring:"reference",reference:!0},"https://github.com/gama-platform/gama/blob/GAMA_1.8.2/msi.gama.models/models/Tutorials/Luneray%20flu/models/model6.gaml\n")))}d.isMDXComponent=!0}}]);