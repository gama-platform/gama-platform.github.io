"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[26593],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>c});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),m=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=m(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),u=m(a),h=r,c=u["".concat(p,".").concat(h)]||u[h]||d[h]||l;return a?n.createElement(c,i(i({ref:t},s),{},{components:a})):n.createElement(c,i({ref:t},s))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=h;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o[u]="string"==typeof e?e:r,i[1]=o;for(var m=2;m<l;m++)i[m]=a[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},21004:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>p,default:()=>c,frontMatter:()=>o,metadata:()=>m,toc:()=>u});var n=a(87462),r=a(63366),l=(a(67294),a(3905)),i=["components"],o={title:"Headless Legacy"},p=void 0,m={unversionedId:"HeadlessLegacy",id:"version-1.9.1/HeadlessLegacy",title:"Headless Legacy",description:"Getting started",source:"@site/versioned_docs/version-1.9.1/HeadlessLegacy.md",sourceDirName:".",slug:"/HeadlessLegacy",permalink:"/wiki/1.9.1/HeadlessLegacy",draft:!1,editUrl:"https://github.com/gama-platform/gama/wiki/HeadlessLegacy/_edit",tags:[],version:"1.9.1",frontMatter:{title:"Headless Legacy"},sidebar:"main",previous:{title:"Headless Server",permalink:"/wiki/1.9.1/HeadlessServer"},next:{title:"Preferences",permalink:"/wiki/1.9.1/Preferences"}},s={},u=[{value:"Getting started",id:"getting-started",level:2},{value:"Experiment Input File",id:"experiment-input-file",level:2},{value:"Simulation",id:"simulation",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Outputs",id:"outputs",level:3},{value:"Output Directory",id:"output-directory",level:2},{value:"Simulation Output",id:"simulation-output",level:2},{value:"Windows PowerShell",id:"windows-powershell",level:3},{value:"Command Prompt",id:"command-prompt",level:3},{value:"Python Script",id:"python-script",level:3}],d={toc:u},h="wrapper";function c(e){var t=e.components,a=(0,r.Z)(e,i);return(0,l.kt)(h,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"getting-started"},"Getting started"),(0,l.kt)("p",null,"This headless mode is the ",(0,l.kt)("em",{parentName:"p"},"Legacy")," one. So, if you are already familiar with headless from version 1.8.1 or older, nothing changed."),(0,l.kt)("p",null,"This mode relies on writing an explicit simulation plan in XML file. Those simulations, mostly for legacy reason, have to be of ",(0,l.kt)("em",{parentName:"p"},"type")," ",(0,l.kt)("inlineCode",{parentName:"p"},"gui")," (which is pretty counterintuitive, but this type let you set the parameter value to each simulation independently), but you don't have to write it explicitly as it's the default type for an experiment."),(0,l.kt)("p",null,"You can generate a first XML file corresponding to an existing experiment with the following command: "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"./gama-headless.sh -xml experimentName /path/to/inputFile.gaml /path/to/outputFile.xml\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"-xml"),": the flag asking the headless to generate a XML file well-formatted for our experiment"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"experimentName"),": the name of the ",(0,l.kt)("inlineCode",{parentName:"li"},"experiment")," you want to run in headless"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"/path/to/inputFile.gaml"),": the path (relative or absolute) to your GAML file containing the experiment you want to run"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"/path/to/outputFile.xml"),": the path (relative or absolute) to the generated XML file")))),(0,l.kt)("p",null,"You can see more in details the content of the generated XML file (applied on the model ",(0,l.kt)("em",{parentName:"p"},"Predator Prey"),") in ",(0,l.kt)("a",{parentName:"p",href:"#experiment-input-file"},"the Experiment Input File part"),"."),(0,l.kt)("p",null,"Once you finished preparing your XML file, you can run it with a command similar to the following one:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"./gama-headless.sh /path/to/file.xml /path/to/generated/outputFolder\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"/path/to/file.xml"),": the path (relative or absolute) to the XML file containing the full exploration plan to run by the headless"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"/path/to/generated/outputFolder"),": the path (relative or absolute) which will be generated by GAMA and hold every output files (variables, snapshots, and console messages)")))),(0,l.kt)("p",null,"You can see result output folder in ",(0,l.kt)("a",{parentName:"p",href:"#simulation-output"},"the Simulation Output part")),(0,l.kt)("h2",{id:"experiment-input-file"},"Experiment Input File"),(0,l.kt)("p",null,"The XML input file contains for example (you can find it next to the file ",(0,l.kt)("inlineCode",{parentName:"p"},"gama-headless.sh")," at the path ",(0,l.kt)("inlineCode",{parentName:"p"},"samples/predatorPrey.xml"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<Experiment_plan>\n    <Simulation experiment="prey_predatorExp" finalStep="1000" id="0" seed="1.0" sourcePath="./samples/predatorPrey/predatorPrey.gaml">\n        <Parameters>\n            <Parameter name="Nb Preys: " type="INT" value="200" var="nb_preys_init"/>\n            <Parameter name="Prey max energy: " type="FLOAT" value="1.0" var="prey_max_energy"/>\n            <Parameter name="Prey max transfert: " type="FLOAT" value="0.1" var="prey_max_transfert"/>\n            <Parameter name="Prey energy consumption: " type="FLOAT" value="0.05" var="prey_energy_consum"/>\n            <Parameter name="Nb predators: " type="INT" value="20" var="nb_predators_init"/>\n            <Parameter name="Predator max energy: " type="FLOAT" value="1.0" var="predator_max_energy"/>\n            <Parameter name="Predator energy transfert: " type="FLOAT" value="0.5" var="predator_energy_transfert"/>\n            <Parameter name="Predator energy consumption: " type="FLOAT" value="0.02" var="predator_energy_consum"/>\n        </Parameters>\n        <Outputs>\n            <Output framerate="1" id="0" name="Number of preys"/>\n            <Output framerate="1" id="1" name="Number of predators"/>\n            <Output framerate="1" id="2" name="main_display"/>\n        </Outputs>\n    </Simulation>\n</Experiment_plan>\n')),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"NB: Several simulations can be determined in one experiment plan. These simulations are run in parallel according to the number of allocated cores.")),(0,l.kt)("h3",{id:"simulation"},"Simulation"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<Simulation experiment="prey_predatorExp" finalStep="1000" id="0" seed="1.0" sourcePath="./samples/predatorPrey/predatorPrey.gaml">\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"experiment")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): determines which experiment should be run on the model. This experiment should exist, otherwise, the headless mode will exit."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"finalStep")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): determines the number of simulation steps you want to run."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"id")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): permits to prefix output files for experiment plans with huge simulations."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"seed")," (optional): permits to set the ",(0,l.kt)("a",{parentName:"li",href:"GlobalSpecies#seed"},"seed")," value of the simulation."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"sourcePath")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): contains the relative or absolute path to read the gaml model."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"until")," (optional): defines a stop condition in GAML. It can be combined with the ",(0,l.kt)("inlineCode",{parentName:"li"},"finalStep")," facet (in this case a simulation will finish when the stop condition is fulfilled or when the final step is reached). ")))),(0,l.kt)("h3",{id:"parameters"},"Parameters"),(0,l.kt)("p",null,"One line per parameter you want to specify a value to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<Parameter name="Nb Preys: " type="INT" value="200" var="nb_preys_init"/>\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"name"),":  name of the parameter in the gaml model"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"type")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"):  type of the parameter (INT, FLOAT, BOOLEAN, STRING)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"value")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): the chosen value"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"var"),":  name of the parameter variable in the gaml model")))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"NB: You need to set at least one of the attributes ",(0,l.kt)("inlineCode",{parentName:"p"},"name")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"var")," in your ",(0,l.kt)("inlineCode",{parentName:"p"},"Parameter")," tag)")),(0,l.kt)("h3",{id:"outputs"},"Outputs"),(0,l.kt)("p",null,"One line per output value you want to retrieve. Outputs can be the name of monitors or displays defined in the 'output' section of experiments, or the names of attributes defined in the experiment or the model itself (in the 'global' section)."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'    ... with the name of a monitor defined in the \'output\' section of the experiment...\n    <Output framerate="1" id="1" name="Number of predators"/>\n    ... with the name of a (built-in) variable defined in the experiment itself...\n    <Output framerate="1" id="2" name="main_display"/>\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"framerate")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): the frequency of the monitoring (each step, every 2 steps, every 100 steps...)."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"id")," (optional): permits to prefix output files for simulation with huge outputs"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"name")," (",(0,l.kt)("strong",{parentName:"li"},"required"),"): name of the output in the 'output'/'permanent' section in the experiment or name of the experiment/model attribute to retrieve"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"output_path")," (optional): change the output directory where snapshot images are saved (for display output only!)")))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"NB: the lower the framerate value is, the longer the experiment."),(0,l.kt)("p",{parentName:"blockquote"},"NB2: if the chosen output is a display, an image is produced and the output file contains the path to access this image")),(0,l.kt)("h2",{id:"output-directory"},"Output Directory"),(0,l.kt)("p",null,"During headless experiments, a directory is created with the following structure:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Outputed-directory-path/\nout\n\u251c\u2500\u2500 console-outputs-0.txt\n\u251c\u2500\u2500 simulation-outputs0.xml\n\u2514\u2500\u2500 snapshot\n    \u251c\u2500\u2500 main_display0-0.png\n    \u251c\u2500\u2500 main_display0-1.png\n    \u251c\u2500\u2500 main_display0-2.png\n    \u251c\u2500\u2500 main_display0-3.png\n    \u251c\u2500\u2500 main_display0-4.png\n    \u2514\u2500\u2500 ...\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"console-outputs-<simulationId>.xml"),": containing every message written in GAMA's console"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"simulation-outputs<simulationId>.xml"),": containing variables' results in a XML format"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"snapshot"),": containing the snapshots (i.e. screenshots of gui displays) produced during the simulation")))),(0,l.kt)("h2",{id:"simulation-output"},"Simulation Output"),(0,l.kt)("p",null,"A file named ",(0,l.kt)("inlineCode",{parentName:"p"},"simulation-output.xml")," is created with the following contents when the experiment runs."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Simulation id=\"0\" >\n    <Step id='0' >\n        <Variable name='main_display' value='main_display2-0.png'/>\n        <Variable name='number_of_preys' value='613'/>\n        <Variable name='number_of_predators' value='51'/>\n                <Variable name='duration' value='6' />\n    </Step>\n    <Step id='1' >\n        <Variable name='main_display' value='main_display2-0.png'/>\n        <Variable name='number_of_preys' value='624'/>\n        <Variable name='number_of_predators' value='51'/>\n                <Variable name='duration' value='5' />\n    </Step>\n        <Step id='2'>\n\n...\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"With:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},'<Simulation id="0" >'),": tag containing results of the simulation. The ",(0,l.kt)("inlineCode",{parentName:"li"},"id")," is set one set in the input file, in the ",(0,l.kt)("a",{parentName:"li",href:"#heading"},"heading part")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"<Step id='0' >"),": one block per step done containing the value of outputs variables. The ",(0,l.kt)("inlineCode",{parentName:"li"},"id")," corresponds to the step number",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"<Variable />")," with:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"name"),": name of the output"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"value"),": the current value of the model variable at the given step.")))))))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"NB: The value of an output is repeated according to the framerate defined in the input experiment file."),(0,l.kt)("p",{parentName:"blockquote"},"NB2: The ",(0,l.kt)("inlineCode",{parentName:"p"},"value")," of an output display gives the relative path to the generated image saved in '.png' format."),(0,l.kt)("h2",{parentName:"blockquote",id:"calling-gama-headless-legacy-on-windows"},"Calling GAMA headless legacy on Windows")),(0,l.kt)("p",null,"The example below assumes that your GAMA application is in folder ",(0,l.kt)("inlineCode",{parentName:"p"},"D:\\software\\")," and your project (model) file is in folder ",(0,l.kt)("inlineCode",{parentName:"p"},"D:\\my_models\\"),"\nThe data structure of the example model as in following. The example models can be found in the GAMA headless folder (GAMA_1.9.0_Windows_with_JDK\\headless\\samples\\predatorPrey)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"predatorPrey\n\u251c\u2500\u2500 includes\n\u2514\u2500\u2500 models\n    \u251c\u2500\u2500 ...\n    \u2514\u2500\u2500 predatorPrey.gaml\n")),(0,l.kt)("p",null,"In the predatorPrey model, we have a ",(0,l.kt)("strong",{parentName:"p"},"GUI experiment")," named ",(0,l.kt)("strong",{parentName:"p"},"prey_predator")),(0,l.kt)("h3",{id:"windows-powershell"},"Windows PowerShell"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"You can open Windows PowerShell, change your directory to the headless folder and run gama-headless command:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd D:\\software\\GAMA_1.9.0_Windows_with_JDK\\headless\\\n.\\gama-headless.bat -xml prey_predator D:\\my_models\\predatorPrey\\models\\predatorPrey.gaml D:\\my_models\\predatorPrey\\models\\predatorPrey.xml\n.\\gama-headless.bat D:\\my_models\\predatorPrey\\models\\predatorPrey.xml D:\\my_models\\predatorPrey\\results\n")),(0,l.kt)("h3",{id:"command-prompt"},"Command Prompt"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"You can open Command Prompt, change your directory to the headless folder D:\\software\\GAMA_1.9.0_Windows_with_JDK\\headless\\ then run the commands:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"gama-headless.bat -xml prey_predator D:\\my_models\\predatorPrey\\models\\predatorPrey.gaml D:\\my_models\\predatorPrey\\models\\predatorPrey.xml\ngama-headless.bat D:\\my_models\\predatorPrey\\models\\predatorPrey.xml D:\\my_models\\predatorPrey\\results\n")),(0,l.kt)("h3",{id:"python-script"},"Python Script"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Your python script will have the following lines of code, mainly using the ",(0,l.kt)("inlineCode",{parentName:"li"},"os")," package to run the native system commands")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},'import os\nos.chdir("D:\\software\\GAMA_1.9.0_Windows_with_JDK\\headless")\nos.system("gama-headless.bat -xml prey_predator D:\\my_models\\predatorPrey\\models\\predatorPrey.gaml D:\\my_models\\predatorPrey\\models\\predatorPrey.xml")\nos.system("gama-headless.bat D:\\my_models\\predatorPrey\\models\\predatorPrey.xml D:\\my_models\\predatorPrey\\results")\n')))}c.isMDXComponent=!0}}]);